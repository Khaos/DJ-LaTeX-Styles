%% -*- Mode: LaTeX Memoir; tab-width: 4;

%% SUACSEThesis.sty    ACSE@SU Thesis
%% !THE TEMPLETE IS BASED ON THE 'MEMOIR' CLASS
%% Created by Dazhi Jiang, 2010-11-16 12:41:58 +0000 (Tue, 16 Nov 2010)

%% ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
%% * Usage
%%   - Available keys
%%     @suacse
%%     @suacseopt
%%   - Short outline
%%     - Initialisation
%%     - Load packages
%%     - Package-setting commands
%%     - Spacing
%%     - Page Layout
%%     - Page Styles
%%     - TOC etc.
%%     - Chapter Styling
%%     - Section, etc., Styling
%%     - Fonts
%%     - Title Page
%%     - Glossaries
%%     - Bibliography
%%     - Hyperref Options
%%     - PGF/TikZ
%%     - Captions
%%     - Initialise Keys
%%     - Load Packages with Options Given by /suacseopt
%%     - Commands
%%     - MISC
%%

%% ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
%% * Change Log
%%   @ 2010-11-16 12:41:58 +0000 (Tue, 16 Nov 2010)
%%     - Create the initial file
%%   @ 2010-11-20 13:33:07 +0000 (Sat, 20 Nov 2010)
%%     - Fix the font options problem, the command, \ProcessPgfPackageOptions,
%%       has to be put somewhere carefully as stated in the code.
%%   @ 2010-12-05 10:07:25 +0000 (Sun,  5 Dec 2010)
%%     - Seperate the pgf-key's definition
%%   @ 2010-12-26 10:08:55 +0000 (Sun, 26 Dec 2010)
%%     - Prepare the first release
%%

%% ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
%% * TODO
%%   - 
%%

%% ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
%% Created by Dazhi Jiang, 2010-11-16 16:04:33 +0000 (Tue, 16 Nov 2010)
%% Initialisation
\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{SUACSEThesis}[2010/11/16 v0.0.1 SUACSE thesis]

%% ! SUACSEThesis relies on the memoir class
\@ifclassloaded{memoir}{\let\endsuacsethesis\relax}{\let\endsuacsethesis\endinput
  \PackageError{SUACSEThesis}{The SUACSEThesis package only works with the memoir class}{\@ehd}}
\endsuacsethesis

%% END: Initialisation
%% ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++


%% ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
%% Created by Dazhi Jiang, 2010-11-16 16:01:56 +0000 (Tue, 16 Nov 2010)
%% Packages

%% * eTeX
\RequirePackage{etex}  % Load Package 'etex'

%% * etoolbox
% \RequirePackage{etoolbox} % Load Package 'etoolbox'

%% * 
\RequirePackage{atbegshi}
\RequirePackage{xspace}  % For command \xspace


%% * PGF key
\RequirePackage{pgfkeys}  % Load Package 'pgfkeys'
\RequirePackage{pgfopts}  % Load Package 'pgfopts'

%% * IF*
\RequirePackage{ifthen}  % Load Package 'ifthen'
\RequirePackage{ifpdf}  % Load Package 'ifpdf'
\RequirePackage{ifxetex}  % Load Package 'ifxetex'



%% * Caption
%%   !!! Some commands defined in memoir are incompatible with the package
%%       caption
% \RequirePackage[width=\textwidth]{caption}
% \captionsetup[table]{position=top}


%% * Input encoding
\RequirePackage[utf8]{inputenc}% sane input encoding
\DeclareUnicodeCharacter{2014}{\dash}
\DeclareUnicodeCharacter{2022}{\item}


%% * Language
\RequirePackage{csquotes}
\MakeOuterQuote{"}

\RequirePackage[british]{babel}


%% * Font & Symbol
%%   - Load the commonly-used font & symbol packages
% \RequirePackage[OT1]{fontenc} % sane font encoding
\RequirePackage[T1]{fontenc} % sane font encoding

\RequirePackage{textcomp} % provide lots of new symbols
\RequirePackage{lmodern} % for sensible sans and tt font

\RequirePackage{pifont}  % Load Package 'pifont'
\newcommand\diameter{\Pisymbol{psy}{'306}} % Define new symbol


%% * MISC
\RequirePackage{calc,listings}
\RequirePackage{verbatim}	% Environment \begin{comment} \end{comment}
\RequirePackage{soul}		% Underlining command: \ul
% \RequirePackage{paralist}  % Load Package 'paralist'
\RequirePackage{enumitem}  % Load Package 'enumitem'


%% * Graph-related package
\RequirePackage{graphics}							% Graphy style
\RequirePackage[usenames, dvipsnames]{color}		% Color
\RequirePackage{graphicx}
%% !!! Comment
%%     The package 'xcolor' has to be loaded before the package 'pstricks'.
\RequirePackage[svgnames]{xcolor}

%%   - PGF-related package
\RequirePackage{pgf}
\RequirePackage{tikz}
\RequirePackage{pgfplots}
\RequirePackage{pgfplotstable}

% We need lots of libraries...
\usetikzlibrary{%
	arrows,%
	calc,%
	fit,%
	patterns,%
	plotmarks,%
	shapes.geometric,%
	shapes.misc,%
	shapes.symbols,%
	shapes.arrows,%
	shapes.callouts,%
	shapes.multipart,%
	shapes.gates.logic.US,%
	shapes.gates.logic.IEC,%
	circuits.logic.US,%
	circuits.logic.IEC,%
	circuits.logic.CDH,%
	circuits.ee.IEC,%
	datavisualization,%
	datavisualization.formats.functions,%
	er,%
	automata,%
	backgrounds,%
	chains,%
	topaths,%
	trees,%
	petri,%
	mindmap,%
	matrix,%
	calendar,%
	folding,%
	fadings,%
	shadings,%
	spy,%
	through,%
	turtle,%
	positioning,%
	scopes,%
	decorations.fractals,%
	decorations.shapes,%
	decorations.text,%
	decorations.pathmorphing,%
	decorations.pathreplacing,%
	decorations.footprints,%
	decorations.markings,%
	shadows,%
	lindenmayersystems,%
	intersections,%
	fixedpointarithmetic,%
	fpu,%
	svg.path,%
	external,%
}

\usepgfplotslibrary{dateplot,%
					units,%
					groupplots}

\RequirePackage{xxcolor} %% Part of <pgf>

% \input{DJpgfmanual-en-macros}
% \input{DJpgfplots-macros}


%% * Table-related packages
\RequirePackage{longtable}			% Long table
\RequirePackage{tabulary}			% Auto adjust column width
\RequirePackage{booktabs}			% Define the hrule width for tabel
\RequirePackage{multirow}			% Multirow

\newcolumntype{Y}{>{\sf}L}

\RequirePackage{tabu}  % Load Package 'tabu'


% %% * Algorithm-related packages
% \RequirePackage{algorithm}			% Algorithm
% \RequirePackage{algpseudocode}		% Algorithmic
% 
% %% Required by titletoc, but should be commented when using \numberwithin
% %% Required by article style maybe.
% %\newcommand{\theHalgorithm}{\arabic{algorithm}}
% 
% \algnewcommand\algorithmicto{\textbf{to}}
% \algrenewtext{For}[3]%
% {\algorithmicfor\ $#1 \gets #2\ \algorithmicto\ #3$ \algorithmicdo}
% 
% \algrenewcommand\algorithmicrequire{\textbf{Input:}}%
% \algrenewcommand\algorithmicensure{\textbf{Output:}}%
% % \algrenewcommand\algorithmiccomment[1]{\hfill\(\triangleright\) #1}%
% % \algrenewcommand\algorithmiccomment[1]{\hfill\(\blacktriangleright\) #1}%


%% * TODO-related packages
\RequirePackage[obeyDraft]{todonotes}  % Load Package 'todonotes'


%% END: Packages
%% ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++


%% ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
%% Created by Dazhi Jiang, 2010-11-16 18:55:59 +0000 (Tue, 16 Nov 2010)
%% Define Package Keys

%% !!! A few comment
%% The key 'chapterstyle' saves the name of the current chapter style. It can
%% be used by another key, e.g., 'headstyle'. The reason is that some head
%% styles set up the chapter styles as well as the section head ones and
%% therefore they have to be set back to the original one.

%% * Initialisation for the keys
%%   - Initialise the macro required by the keys
\def\@suacse@chapter@style{default}	% Initial chapter style: default

%% * Use '\suacseset' to set-up the suacse keys 
\def\suacseset#1{\pgfkeys{/suacse/.cd,#1}}

%% * Use '\suacse@opt@set' to set-up the suacseopt keys 
\def\suacse@opt@set#1{\pgfkeys{/suacseopt/.cd,#1}}


% \newcommand*{\setsuacsespacing}[1]{%
%   \let\SUACSESpacing#1
%   \SUACSESpacing}
% \setsuacsespacing{\OnehalfSpacing}

%% END: Define Package Keys
%% ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++


%% ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
%% Created by Dazhi Jiang, 2010-12-05 10:19:36 +0000 (Sun,  5 Dec 2010)
%% Spacing

%% * Define spacing-related keys
\pgfkeys{%
	/suacse/.cd,
	%% - Spacing
	spacing/.is choice,
	spacing/single/.code={\SingleSpacing},
	spacing/onehalf/.code={\OnehalfSpacing},
	spacing/double/.code={\DoubleSpacing},
	spacing/.default=onehalf,
	% spacing/.code args={#1 equal to #2}{\if#1}
	spacingfactor/.code={\setSingleSpace{#1} \SingleSpacing},
}

%% * Define spacing-related option keys
\pgfkeys{%
	%% - Spacing
	/suacseopt/.cd,
	spacing/.code={\suacseset{spacing=#1}},
	spacingfactor/.code={\suacseset{spacingfactor=#1}},
}

%% END: Spacing
%% ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++


%% ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
%% Created by Dazhi Jiang, 2010-11-16 16:02:34 +0000 (Tue, 16 Nov 2010)
%% Page Layout

%% * Define page-layout-ralated option keys
\pgfkeys{%
	/suacseopt/.cd,
	pagelayout/.is choice,
	pagelayout/asu/.code={\pagelayout@asu},
	pagelayout/memsty/.code={\pagelayout@memsty},
	pagelayout/acsei/.code={\pagelayout@acsei},
	pagelayout/acseii/.code={\pagelayout@acseii},
	% pagelayout/.code={\suacseset{pagelayout=#1}},
}

%% * Some useful lengths for layout purposes
\newlength{\toptafiddle}
\newlength{\bottafiddle}
\newlength{\topfiddle}
\newlength{\botfiddle}
\newlength{\linespace}

%% * ASU page layout
% \renewcommand{\pagelayout@asu}{%
\newcommand{\pagelayout@asu}{%
	%% * set up margins for a4paper stock
	%%   - left, right and textwidth
	\setlrmarginsandblock{1.5in}{1in}{*}

	%% for main body
	%% bottom of text at 1in, footer below
	%% top of header at 1in, first text line double spaced below base of header
	\setlength{\linespace}{\baselineskip} %% the current equivalent of \onelineskip
	\setlength{\headheight}{\onelineskip}
	\setlength{\headsep}{\linespace}
	\addtolength{\headsep}{-\topskip}
	\setlength{\uppermargin}{1in}
	\addtolength{\uppermargin}{\headheight}
	\addtolength{\uppermargin}{\headsep}
	\setlength{\lowermargin}{1in}
	\setlength{\footskip}{\onelineskip}
	\setlength{\textheight}{\paperheight}
	\addtolength{\textheight}{-\uppermargin}
	\addtolength{\textheight}{-\lowermargin}
	%% the fiddle lengths (..ta.. for title/approval page, others for prelims)
	%% (determined by many trials and errors)
	\setlength{\toptafiddle}{2\linespace}
	\setlength{\topfiddle}{\toptafiddle}
	\setlength{\bottafiddle}{\onelineskip}
	\setlength{\botfiddle}{0pt} % actually this is not used

	\checkandfixthelayout[nearest]
}
\@onlypreamble\pagelayout@asu

%% * memsty page layout
% \renewcommand{\pagelayout@memsty}{%
\newcommand{\pagelayout@memsty}{%
	%% set up the page layout
	\settrimmedsize{11in}{210mm}{*}
	\setlength{\trimtop}{0pt}
	\setlength{\trimedge}{\stockwidth}
	\addtolength{\trimedge}{-\paperwidth}
	\settypeblocksize{7.75in}{33pc}{*}
	\setulmargins{4cm}{*}{*}
	\setlrmargins{1.25in}{*}{*}
	\setmarginnotes{17pt}{51pt}{\onelineskip}
	\setheadfoot{\onelineskip}{2\onelineskip}
	\setheaderspaces{*}{2\onelineskip}{*}
	\setsidefeet{\marginparsep}{9em}%
	   {\onelineskip}{0pt}%
	   {\normalfont\footnotesize}{\textheight}%
	\checkandfixthelayout
}
\@onlypreamble\pagelayout@memsty

%% * ACSE page layout I
% \renewcommand{\pagelayout@acsei}{%
\newcommand{\pagelayout@acsei}{%
	%% * set up margins for a4paper stock
	%%   - left, right and textwidth
	\setlrmarginsandblock{1.5in}{1.2in}{*}

	%% for main body
	%% bottom of text at 1in, footer below
	%% top of header at 1in, first text line double spaced below base of header
	\setlength{\linespace}{\baselineskip} %% the current equivalent of \onelineskip
	\setlength{\headheight}{\onelineskip}
	\setlength{\headsep}{\linespace}
	\addtolength{\headsep}{-\topskip}
	\setlength{\uppermargin}{1.2in}
	\addtolength{\uppermargin}{\headheight}
	\addtolength{\uppermargin}{\headsep}
	\setlength{\lowermargin}{1.2in}
	\setlength{\footskip}{\onelineskip}
	\setlength{\textheight}{\paperheight}
	\addtolength{\textheight}{-\uppermargin}
	\addtolength{\textheight}{-\lowermargin}
	%% the fiddle lengths (..ta.. for title/approval page, others for prelims)
	%% (determined by many trials and errors)
	\setlength{\toptafiddle}{2\linespace}
	\setlength{\topfiddle}{\toptafiddle}
	\setlength{\bottafiddle}{\onelineskip}
	\setlength{\botfiddle}{0pt} % actually this is not used

	\checkandfixthelayout[nearest]
}
\@onlypreamble\pagelayout@acsei

%% * ACSE page layout II
% \renewcommand{\pagelayout@acseii}{%
\newcommand{\pagelayout@acseii}{%
	%% set up the page layout%
	%% \settrimmedsize is incompatible with the command,
	%%   \AtBeginDocument{\usepackage{graphicx}}
	%% which is included in the package 'mathtools'.
	% \settrimmedsize{11in}{210mm}{*} % a4paper: 297mm * 210mm%
	\setlength{\trimtop}{0pt}
	\setlength{\trimedge}{\stockwidth}
	\addtolength{\trimedge}{-\paperwidth}
	\settypeblocksize{8.5in}{31pc}{*}
	\setulmargins{4.5cm}{*}{*}
	\setlrmargins{1.8in}{*}{*}
	\setmarginnotes{17pt}{51pt}{\onelineskip}
	\setheadfoot{\onelineskip}{2\onelineskip}
	\setheaderspaces{*}{2\onelineskip}{*}
	\setsidefeet{\marginparsep}{9em}%
	   {\onelineskip}{0pt}%
	   {\normalfont\footnotesize}{\textheight}%
	\setlength{\footskip}{\onelineskip}
	\setlength{\footnotesep}{\onelineskip}
	\checkandfixthelayout
	% \fixpdflayout
}
\@onlypreamble\pagelayout@acseii

% \renewcommand{\pagelayout@acseii}{}
% \newcommand{\pagelayout@acseii}{}


%% END: Page Layout
%% ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++


%% ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
%% Created by Dazhi Jiang, 2010-11-16 16:03:55 +0000 (Tue, 16 Nov 2010)
%% Page Styles
%%   * \markboth takes the effect for the twosides documents, while \markright
%%     is used for the oneside documents.


%% * Define page-style-related keys
\pgfkeys{%
	/suacse/.cd,
	%% - Page style
	loadpagestyle/.is choice,
	loadpagestyle/asu/.code={\suacse@loadpagestyle@asu},
	loadpagestyle/wspr/.code={\suacse@loadpagestyle@wspr},
	loadpagestyle/acsei/.code={\suacse@loadpagenumberstyle
							   \suacse@loadpagestyle@acsei},
	pagestyle/.code={\pagestyle{#1}},
}

%% * Define page-style-related option keys



%% * Declare the style switchers for page number
\newif\if@suacse@page@numbering@style@default
\newif\if@suacse@page@numbering@style@plain
\newif\if@suacse@page@numbering@style@bold
\newif\if@suacse@page@numbering@style@largebold
\newif\if@suacse@page@numbering@style@blackbg
\newif\if@suacse@page@numbering@style@bari
\newif\if@suacse@page@numbering@style@acsei

\newcommand*{\@suacse@switch@page@numbering@off}{%
	\@suacse@page@numbering@style@defaultfalse
	\@suacse@page@numbering@style@plainfalse
	\@suacse@page@numbering@style@boldfalse
	\@suacse@page@numbering@style@largeboldfalse
	\@suacse@page@numbering@style@blackbgfalse
	\@suacse@page@numbering@style@barifalse
	\@suacse@page@numbering@style@acseifalse
}

%% * Define page-number-style-related keys
%%   ! The 'pagenumberstyle' key has to be set up before any \pagestyle
%%     command.
\pgfkeys{%
	/suacse/.cd,
	%% - Page number style
	pagenumberstyle/.is choice,
	pagenumberstyle/default/.code={\@suacse@switch@page@numbering@off
							\@suacse@page@numbering@style@defaulttrue},
	pagenumberstyle/plain/.code={\@suacse@switch@page@numbering@off
							\@suacse@page@numbering@style@plaintrue},
	pagenumberstyle/bold/.code={\@suacse@switch@page@numbering@off
							\@suacse@page@numbering@style@boldtrue},
	pagenumberstyle/largebold/.code={\@suacse@switch@page@numbering@off
							\@suacse@page@numbering@style@largeboldtrue},
	pagenumberstyle/blackbg/.code={\@suacse@switch@page@numbering@off
							\@suacse@page@numbering@style@blackbgtrue},
	pagenumberstyle/bari/.code={\@suacse@switch@page@numbering@off
							\@suacse@page@numbering@style@baritrue},
	pagenumberstyle/acsei/.code={\@suacse@switch@page@numbering@off
							\@suacse@page@numbering@style@acseitrue},
	pagenumberstyle/.default=default,
}


%% * Define page-number style
%%   ! The following styles are only available when ACSE page styles are used.
\newcommand{\suacse@loadpagenumberstyle}{%
	%% - Load required package
	% \RequirePackage[svgnames]{xcolor}  % Load Package 'xcolor'
	% \RequirePackage{tikz}  % Load Package 'tikz'
	% \providecommand\thesispage{\normalfont p.\,\thepage}
	% \providecommand\thesispage{\normalfont \colorbox{black}%
	% 		{\color{white}p.\,\thepage}}
	%% - Default style: number only
	\@ifundefined{@suacse@pagenumber@font}%
		{\newcommand*{\@suacse@pagenumber@font}{\normalfont}}
		{\renewcommand*{\@suacse@pagenumber@font}{\normalfont}}
	\@ifundefined{@suacse@pagenumber@text}%
		{\newcommand*{\@suacse@pagenumber@text}{\thepage}}
		{\renewcommand*{\@suacse@pagenumber@text}{\thepage}}
	\@ifundefined{@suacse@pagenumber}%
		{\newcommand{\@suacse@pagenumber}%
			{\@suacse@pagenumber@font\@suacse@pagenumber@text}}{}
	\if@suacse@page@numbering@style@default
		\renewcommand*{\@suacse@pagenumber@font}{\normalfont}
		\renewcommand*{\@suacse@pagenumber@text}{\thepage}
	\fi
	%% - Plain style
	\if@suacse@page@numbering@style@plain
		\renewcommand{\@suacse@pagenumber@text}{%
			\if@mainmatter
				p.\,\thepage
			\else
				\thepage
			\fi
		}
	\fi
	%% - Bold style
	\if@suacse@page@numbering@style@bold
		\renewcommand{\@suacse@pagenumber@font}{\normalfont\bfseries}
	\fi
	%% - Large-bold style
	\if@suacse@page@numbering@style@largebold
		\renewcommand{\@suacse@pagenumber@font}{\normalfont\large\bfseries}
	\fi
	%% - Black-background style
	\if@suacse@page@numbering@style@blackbg
		\renewcommand{\@suacse@pagenumber@font}{\normalfont\bfseries}
		\renewcommand{\@suacse@pagenumber@text}{%
			\if@mainmatter
				p.\,\thepage
			\else
				\thepage
			\fi
		}
		\renewcommand{\@suacse@pagenumber}{\@suacse@pagenumber@font %
			\tikz [baseline=0pt]
			\node [preaction={draw=black, line width=2.5pt}]
				  [draw=lightgray,
				   line width=0.5pt,
				   fill=black!100,
				   text=white,
				   anchor=base,
				   rounded corners=2pt,
				   minimum height=1.5em,
				   minimum width=2em]		{\@suacse@pagenumber@text};
		}
	\fi
	%% - Bar style I
	\if@suacse@page@numbering@style@bari
		\renewcommand{\@suacse@pagenumber@font}{\normalfont\bfseries}
		\renewcommand{\@suacse@pagenumber@text}{\thepage}
		\renewcommand{\@suacse@pagenumber}{\@suacse@pagenumber@font %
			\if@mainmatter
				\@suacse@pagenumber@text\;%
				\tikz [baseline=0pt]{%[baseline=(current bounding box.south)]
				\path [use as bounding box] (0, 0) rectangle (1.5mm, 2.5ex);
				% \filldraw[anchor=base] (0,0) rectangle (2mm, 2.5ex); \;\thepage
				% \filldraw [anchor=base,
				% \node [anchor=base,
				% 	   fill=gray,
				% 	   minimum height=2ex,
				% 	   minimum width=1.2mm] {};}
				\filldraw [anchor=base,
						   gray,] (0,-1.3mm) rectangle (1.3mm, 2.3ex);}
			\else
				\@suacse@pagenumber@text%
				% \;%
				% \tikz [baseline=0pt]{%[baseline=(current bounding box.south)]
				% \path [use as bounding box] (0, 0) rectangle (2mm, 2ex);
				% % \filldraw[anchor=base] (0,0) rectangle (2mm, 2.5ex); \;\thepage
				% \path [anchor=base] (0,-1mm) rectangle (1.5mm, 1.8ex);}
			\fi
		}
	\fi
	%% - ACSE style I
	\if@suacse@page@numbering@style@acsei
		\renewcommand{\@suacse@pagenumber@font}{\normalfont\bfseries}
		\renewcommand{\@suacse@pagenumber@text}{%
			\if@mainmatter
				p.\,\thepage
			\else
				\thepage
			\fi
		}
		\renewcommand{\@suacse@pagenumber}{\@suacse@pagenumber@font %
			\tikz [baseline=0pt]
			\node [anchor=base,
				   rounded corners=2pt,
				   minimum height=1.5em,
				   minimum width=2em]		{\@suacse@pagenumber@text};
		}
	\fi
}


%% * ASU thesis page style
% \renewcommand{\suacse@loadpagestyle@asu}{%
\newcommand{\suacse@loadpagestyle@asu}{%
	%% - Main text
	\makepagestyle{asu}
	  \makeevenhead{asu}{\thepage}{}{}
	  \makeoddhead{asu}{}{}{\thepage}
	%% - For continuation pages of the ToC, LoF, LoT
	\makepagestyle{toc}
	  \makeevenfoot{toc}{}{\thepage}{}
	  \makeoddfoot{toc}{}{\thepage}{}
	  \makeevenhead{toc}{Chapter}{}{Page}
	  \makeoddhead{toc}{Chapter}{}{Page}
	\makepagestyle{lof}
	  \makeevenfoot{lof}{}{\thepage}{}
	  \makeoddfoot{lof}{}{\thepage}{}
	  \makeevenhead{lof}{Figure}{}{Page}
	  \makeoddhead{lof}{Figure}{}{Page}
	\makepagestyle{lot}
	  \makeevenfoot{lot}{}{\thepage}{}
	  \makeoddfoot{lot}{}{\thepage}{}
	  \makeevenhead{lot}{Table}{}{Page}
	  \makeoddhead{lot}{Table}{}{Page}
	%% Use \pagestyle{plain} for prelims
}

%% * Will Robertson's page thesis style
% \renewcommand{\suacse@loadpagestyle@wspr}{%
\newcommand{\suacse@loadpagestyle@wspr}{%
	\if@twoside
		% 
	\else
		\setlength{\headheight}{\baselineskip}
		\setlength{\headwidth}{\textwidth+\marginparsep+0.5\marginparwidth}
		\makepagestyle{wspr}
		\makepsmarks{wspr}{%
		  % \let\@mkboth\markboth%
		  \def\chaptermark####1{%
		    \markright{%
		      \if@mainmatter
		        \textsc{Chapter \thechapter:} %
		      \fi
		      ####1}}%
		  \def\sectionmark####1{%
		    \markright{%
		      \if@mainmatter
		        \textsc{\S\thesection:} %
		      \fi
		      ####1}}}
		\makerunningwidth{wspr}{\headwidth}
		\makeheadposition{wspr}{flushright}{flushleft}{}{}
		\makeevenhead{wspr}{\makebox[0pt][c]{\thesispage}} {} {\small\leftmark}
		\makeoddhead{wspr} {\small\rightmark}              {} {\thesispage}
		% \makeheadrule{wspr}{\headwidth}{0.5pt}
	\fi
}

%% * ACSE thesis page style I
%%   - Load page style
% \renewcommand{\suacse@loadpagestyle@acsei}{%
\newcommand{\suacse@loadpagestyle@acsei}{%
	\if@twoside
		\makepagestyle{acsei}
		  \makepsmarks{acsei}{%
		    % \let\@mkboth\markboth%
		    \def\chaptermark####1{%
		      \markboth{%
		        \if@mainmatter
		          % \textsc{\S\thechapter:} %
		          \textsc{Chapter\ \thechapter:} %
		        \fi
		        ####1}{####1}}%
		    \def\sectionmark####1{%
		      \markright{%
		        \if@mainmatter
		          \textsc{\S\thesection:} %
		        \fi
		        ####1}}}
		  \makeevenhead{acsei}{\makebox[0pt][c]{\@suacse@pagenumber}} {} {\small\leftmark}
		  \makeoddhead{acsei} {\small\rightmark}              {} {\@suacse@pagenumber}
		  \setlength{\headwidth}{\textwidth}
		  \makeheadrule{acsei}{\headwidth}{0.4pt}
	\else
		\setlength{\headheight}{\baselineskip}
		% \setlength{\headwidth}{\textwidth}
		\setlength{\headwidth}{\textwidth+\marginparsep+0.2\marginparwidth}
		\makepagestyle{acsei}
		  \makepsmarks{acsei}{%
		    % \let\@mkboth\markboth%
		    \def\chaptermark####1{%
		      \markright{%
		        \if@mainmatter
		          % \textsc{\S\thechapter:} %
		          \textsc{Chapter\ \thechapter:} %
		        \fi
		        ####1}}%
		    \def\sectionmark####1{%
		      \markright{%
		        \if@mainmatter
		          \textsc{\S\thesection:} %
		        \fi
		        ####1}}}
		  % \makerunningwidth{acsei}{\headwidth}
		  \makerunningwidth{acsei}[\headwidth]{\textwidth}
		  \makeheadposition{acsei}{flushright}{flushleft}{}{}
		  % \if@mainmatter
		    \makeevenhead{acsei}{\makebox[0pt][c]{\@suacse@pagenumber}} {} {\small\leftmark}
		    \makeoddhead{acsei} {\small\rightmark}              {} {\@suacse@pagenumber}
		  % \else
		  %   \makeevenhead{acsei}{\makebox[0pt][c]{\thepage}} {} {\small\leftmark}
		  %   \makeoddhead{acsei} {\small\rightmark}              {} {\thepage}
		  % \fi
		  % \setlength{\headwidth}{\textwidth}
		  % \makeheadrule{acsei}{\headwidth}{0.4pt}
		  \makeheadrule{acsei}{\textwidth}{0.6pt}
		
		% \if@mainmatter
		% \setlength{\headwidth}{\textwidth+\marginparsep+0.4\marginparwidth}
		\makerunningwidth{plain}{\headwidth}
		% \makerunningwidth{plain}[\headwidth]{\textwidth}
		\makeheadposition{plain}{flushright}{flushleft}{flushright}{flushleft}
		\makeoddfoot{plain}{}{}{\@suacse@pagenumber}
		% \else
		% \makeoddfoot{plain}{}{}{\thepage}
		% \fi
	\fi
}

%% Pagestyle: headings, demo codes from the memoir class
% \if@twoside
%   \makepagestyle{headings}
%     \makepsmarks{headings}{%
%       \def\chaptermark##1{%
%         \markboth{\memUChead{%
%           \ifnum \c@secnumdepth >\m@ne
%             \if@mainmatter
%               \@chapapp\ \thechapter. \ %
%             \fi
%           \fi
%           ##1}}{}}%
%       \def\tocmark{\markboth{\memUChead{\contentsname}}{\memUChead{\contentsname}}}%
%       \def\lofmark{\markboth{\memUChead{\listfigurename}}{\memUChead{\listfigurename}}}%
%       \def\lotmark{\markboth{\memUChead{\listtablename}}{\memUChead{\listtablename}}}%
%       \def\bibmark{\markboth{\memUChead{\bibname}}{\memUChead{\bibname}}}%
%       \def\indexmark{\markboth{\memUChead{\indexname}}{\memUChead{\indexname}}}%
%       \def\sectionmark##1{%
%         \markright{\memUChead{%
%           \ifnum \c@secnumdepth > \z@
%             \thesection. \ %
%           \fi
%           ##1}}}}
%     \makepsmarks{headings}{%
%       \createmark{chapter}{left}{shownumber}{\@chapapp\ }{. \ }
%       \createmark{section}{right}{shownumber}{}{. \ }
%       \createplainmark{toc}{both}{\contentsname}
%       \createplainmark{lof}{both}{\listfigurename}
%       \createplainmark{lot}{both}{\listtablename}
%       \createplainmark{bib}{both}{\bibname}
%       \createplainmark{index}{both}{\indexname}
%       \createplainmark{glossary}{both}{\glossaryname}
%     }
%     \makeevenhead{headings}{\thepage}{}{\slshape\leftmark}
%     \makeoddhead{headings}{\slshape\rightmark}{}{\thepage}
% \else
%   \makepagestyle{headings}
%     \makepsmarks{headings}{%
%       \def\chaptermark##1{%
%         \markright{\memUChead{%
%           \ifnum \c@secnumdepth >\m@ne
%             \if@mainmatter
%               \@chapapp\ \thechapter. \ %
%             \fi
%           \fi
%           ##1}}}%
%       \def\tocmark{\markright{\memUChead{\contentsname}}}%
%       \def\lofmark{\markright{\memUChead{\listfigurename}}}%
%       \def\lotmark{\markright{\memUChead{\listtablename}}}%
%       \def\bibmark{\markright{\memUChead{\bibname}}}%
%       \def\indexmark{\markright{\memUChead{\indexname}}}}
%     \makepsmarks{headings}{%
%       \createmark{chapter}{right}{shownumber}{\@chapapp\ }{. \ }
%       \createplainmark{toc}{right}{\contentsname}
%       \createplainmark{lof}{right}{\listfigurename}
%       \createplainmark{lot}{right}{\listtablename}
%       \createplainmark{bib}{right}{\bibname}
%       \createplainmark{index}{right}{\indexname}
%       \createplainmark{glossary}{right}{\glossaryname}
%     }
%     \makeoddhead{headings}{\slshape\rightmark}{}{\thepage}
% \fi

%% END: Page Styles
%% ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++


%% ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
%% Created by Dazhi Jiang, 2010-11-16 16:10:39 +0000 (Tue, 16 Nov 2010)
%% TOC etc.

%% * Set the default TOC depth
\maxtocdepth{subsection}    % include subsections in ToC

%% * Declare switchers for TOC
\newif\ifsuacse@toc@short@show
\newif\ifsuacse@toc@style@memsty
\newif\ifsuacse@toc@style@wspr
\newif\ifsuacse@toc@style@acsei

\newif\if@suacse@toc@toc@show

%% * Define TOC-related keys
\pgfkeys{%
	/suacse/.cd,
	%% - TOC
	showshorttoc/.is if = suacse@toc@short@show,
	showshorttoc/.default = false,
	tocstyle@memsty/.is if = suacse@toc@style@memsty,
	tocstyle@wspr/.is if = suacse@toc@style@wspr,
	tocstyle@acsei/.is if = suacse@toc@style@acsei,
	loadtocstyle/.is choice,
	loadtocstyle/memsty/.style = {tocstyle@memsty=true,%
								  tocstyle@wspr=false,%
								  tocstyle@acsei=false,},
	loadtocstyle/wspr/.style = {tocstyle@memsty=false,%
								tocstyle@wspr=true,%
								tocstyle@acsei=false,},
	loadtocstyle/acsei/.style = {tocstyle@memsty=false,%
								 tocstyle@wspr=false,%
								 tocstyle@acsei=true,},
	loadtocstyle/.default = acsei,
	loadtocstyle/.append code = {\suacse@loadtocstyle},
	tocstyle/.style = {loadtocstyle=#1},
	tocdepth/.code = {\settocdepth{#1}},
	maxtocdepth/.code = {\maxtocdepth{#1}},
	addtoctotoc/.is if = @suacse@toc@toc@show,
	addtoctotoc/.default = true,
	tocparskip/.code={\setlength{\cftparskip}{#1}},
}

%% * Define TOC-related option keys


%% * Load TOC styles

%%   - Switcher required by style
\newif\if@shorttoc

%%   - Pre-defined command
%%     - Hide content line in short toc
%%       !!! DO NOT PUT ANY \clearpage inside of this environment.
\newenvironment {hideshorttoc} {
  \addtocontents{toc}{ \protect\if@shorttoc \protect\else }
}{
  \addtocontents{toc}{ \protect\fi }
}

%%   - Pre-define commands for TOC
\newcommand{\setupshorttoc}{}
\newcommand{\setupparasubsecs}{}
\newcommand{\setupmaintoc}{}


\newcommand{\suacse@loadtocstyle}{%
%% * Memsty style
\ifsuacse@toc@style@memsty
	%% - Define short TOC
	\renewcommand*{\setupshorttoc}{%
	  \@shorttoctrue
	  \renewcommand*{\contentsname}{Short contents}
	  \let\oldchangetocdepth\changetocdepth
	  \let\oldprecistoctext\precistoctext
	  \renewcommand{\precistoctext}[1]{}
	  \let\oldcftchapterfillnum\cftchapterfillnum
	  \renewcommand*{\changetocdepth}[1]{}
	  \setcounter{tocdepth}{0}% chapters
	  % \renewcommand*{\cftpartfont}{\hfill\sffamily}
	  % \renewcommand*{\cftpartpagefont}{\normalfont}
	  % \renewcommand*{\cftpartleader}{ \textperiodcentered\space}
	  % \renewcommand*{\cftpartafterpnum}{\cftparfillskip}
	  \renewcommand*{\cftchapterfont}{\hfill\sffamily}
	  \renewcommand*{\cftchapterpagefont}{\normalfont}
	  \renewcommand*{\cftchapterleader}{ \textperiodcentered\space}
	  \renewcommand*{\cftchapterafterpnum}{\cftparfillskip}
	  % \setpnumwidth{0em}
	  % \setpnumwidth{1.5em}
	  \renewcommand*{\cftchapterfillnum}[1]{%
	    {\cftchapterleader}\nobreak
	    \hbox to 1.5em{\cftchapterpagefont ####1\hfil}\cftchapterafterpnum\par}
	  \setrmarg{0.3\textwidth}
	  \setlength{\unitlength}{\@tocrmarg}
	  \addtolength{\unitlength}{1.5em}
	  \let\oldcftpartformatpnum\cftpartformatpnum
	  \renewcommand*{\cftpartformatpnum}[1]{%
	    \hbox to\unitlength{{\cftpartpagefont ####1}}}
	  \let\oldcftbookformatpnum\cftbookformatpnum
	  \renewcommand*{\cftbookformatpnum}[1]{%
	    \hbox to\unitlength{{\cftbookpagefont ####1}}}}

	\renewcommand*{\setupparasubsecs}{%
	  \@shorttocfalse
	  \let\oldnumberline\numberline
	  \renewcommand*{\cftsubsectionfont}{\itshape}
	  \renewcommand*{\cftsubsectionpagefont}{\itshape}
	  \renewcommand{\l@subsection}[2]{
	    \ifnum\c@tocdepth > 1\relax
	      \def\numberline########1{\textit{########1}~}%
	      \leftskip=\cftsubsectionindent
	      \rightskip=\@tocrmarg
	      % \advance\rightskip 0pt plus \hsize % uncomment this for raggedright
	      % \advance\rightskip 0pt plus 2em    % uncomment this for semi-ragged
	      \parfillskip=\fill
	      \ifhmode ,\ \else\noindent\fi
	      \ignorespaces 
	      {\cftsubsectionfont ####1}~{\cftsubsectionpagefont####2}%
	       \let\numberline\oldnumberline\ignorespaces
	    \fi}}

	\AtEndDocument{\addtocontents{toc}{\par}}%%% OK

	%%   - Define long TOC
	\renewcommand*{\setupmaintoc}{%
	  \renewcommand{\contentsname}{Contents}
	  \let\changetocdepth\oldchangetocdepth
	  \let\precistoctext\oldprecistoctext
	  \let\cftchapterfillnum\oldcftchapterfillnum
	  \addtodef{\cftchapterbreak}{\par}{}
	  \renewcommand*{\cftchapterfont}{\normalfont\sffamily}
	  \renewcommand*{\cftchapterleader}{\sffamily\cftdotfill{\cftchapterdotsep}}
	  \renewcommand*{\cftchapterafterpnum}{}
	  \renewcommand{\cftchapterbreak}{\par\addpenalty{-\@highpenalty}}
	  \setpnumwidth{2.55em}
	  \setrmarg{3.55em}
	  \setcounter{tocdepth}{2}
	  \let\cftpartformatpnum\oldcftpartformatpnum
	  \addtodef{\cftpartbreak}{\par}{}
	  \let\cftbookformatpnum\oldcftbookformatpnum
	  \addtodef{\cftbookbreak}{\par}{}
	}
\fi

%% * Will Robertson's style
\ifsuacse@toc@style@wspr
	\renewcommand*{\setupshorttoc}{%
	  \@shorttoctrue
	  \renewcommand*{\contentsname}{Short contents}
	  \let\oldchangetocdepth\changetocdepth
	  \renewcommand{\precistoctext}[1]{%
	    \nobreak
	    \begin{quote}
	      \leftskip    = 0cm plus  0.5fil
	      \rightskip   = 0cm plus -0.5fil
	      \parfillskip = 0cm plus    1fil
	      \footnotesize ####1
	    \end{quote}
	  }
	  \let\oldcftchapterfillnum\cftchapterfillnum
	  \renewcommand*{\changetocdepth}[1]{}
	  \setcounter{tocdepth}{0}% chapters
	  %
	  \renewcommand*{\cftchapterfont}{\hfill}
	  \renewcommand*{\cftchapterfillnum}[1]{%
	    \quad \nobreak p.\,####1\hfill \null \par
	  }
	  %
	  \renewcommand*{\cftpartfont}{\hfill \bfseries}
	  \renewcommand*{\cftpartfillnum}[1]{\hfill\null\par}
	}

	\renewcommand*{\setupparasubsecs}{%
	  \@shorttocfalse
	  \let\oldnumberline\numberline
	  \renewcommand \cftsubsectionfont     {\small}
	  \renewcommand \cftsubsectionpagefont {\upshape\small}
	  \renewcommand \l@subsection [2] {%
	    \ifnum\c@tocdepth > 1
	      \def\numberline########1{\parsesubsection########1\@nil}%
	      \leftskip=\cftsubsectionindent
	      \rightskip=\@tocrmarg
	      \advance\rightskip 0pt plus 2em
	      \parfillskip=\fill
	      \ifhmode
	        \unskip\unskip\unskip\unskip\unskip\unskip\unskip\unskip \unskip\unskip\unskip\unskip\unskip\unskip\unskip\unskip\,,\space
	      \else
	        \noindent
	      \fi
	      \ignorespaces
	      {\cftsubsectionfont ####1}~{\cftsubsectionpagefont####2}%
	       \let\numberline\oldnumberline\expandafter\ignorespaces
	    \fi
	  }%
	}

	\def\parsesubsection##1.##2.##3\@nil{##3 \itshape}

	\AtEndDocument{\addtocontents{toc}{\par}}%%% OK

	\renewcommand*{\setupmaintoc}{%
	  \renewcommand{\contentsname}{Contents}
	  \let\changetocdepth\oldchangetocdepth
	  \renewcommand{\precistoctext}[1]{}
	  \let\cftchapterfillnum\oldcftchapterfillnum
	  \addtodef{\cftchapterbreak}{\par}{}
	  \renewcommand*{\cftchapterfont}{\normalfont}
	  \renewcommand*{\cftchapterleader}{\cftdotfill{\cftchapterdotsep}}
	  \renewcommand*{\cftchapterafterpnum}{}
	  \renewcommand{\cftchapterbreak}{\par\addpenalty{-\@highpenalty}}
	  \setpnumwidth{2.55em}
	  \setrmarg{3.55em}
	  \setcounter{tocdepth}{2}
	  \let\cftpartformatpnum\oldcftpartformatpnum
	  \addtodef{\cftpartbreak}{\par}{}
	  \let\cftbookformatpnum\oldcftbookformatpnum
	  \addtodef{\cftbookbreak}{\par}{}
	}

	\renewcommand\chapterprecistoc[1]{%
	  \addtocontents{toc}{\protect\precistoctext{##1}}%
	}

	\renewcommand\chapterprecishere[1]{}

\fi

%% * ACSE style I
\ifsuacse@toc@style@acsei
	%% - Define short TOC
	\renewcommand*{\setupshorttoc}{%
	  \@shorttoctrue
	  \renewcommand*{\contentsname}{Short contents}
	  \let\oldchangetocdepth\changetocdepth
	  \let\oldprecistoctext\precistoctext
	  \renewcommand{\precistoctext}[1]{}
	  \let\oldcftchapterfillnum\cftchapterfillnum
	  \renewcommand*{\changetocdepth}[1]{}
	  \setcounter{tocdepth}{0}% chapters
	  % \renewcommand*{\cftpartfont}{\hfill\sffamily}
	  % \renewcommand*{\cftpartpagefont}{\normalfont}
	  % \renewcommand*{\cftpartleader}{ \textperiodcentered\space}
	  % \renewcommand*{\cftpartafterpnum}{\cftparfillskip}
	  % \newlength\@suacse@toc@short@entrytitle@length
	  % \setlength{\@suacse@toc@short@entrytitle@length}{0.6\textwidth}
	  % \let\oldctfchapterfont
	  \renewcommand*{\cftchapterfont}{\hfill\sffamily}
	  \renewcommand*{\cftchapterpagefont}{\normalfont}
	  \renewcommand*{\cftchapterleader}{ \textperiodcentered\space}
	  \renewcommand*{\cftchapterafterpnum}{\cftparfillskip}
	  % \renewcommand*{\cftchapterafterpnum}{\hfill}
	  % \setpnumwidth{0em}
	  % \setpnumwidth{1.5em}
	  \renewcommand*{\cftchapterfillnum}[1]{%
	    {\cftchapterleader}\nobreak
	    \hbox to 1.5em{\cftchapterpagefont ####1\hfil}\cftchapterafterpnum\par}
	  \setrmarg{0.3\textwidth}
	  \setlength{\unitlength}{\@tocrmarg}
	  \addtolength{\unitlength}{1.5em}
	  \let\oldcftpartformatpnum\cftpartformatpnum
	  \renewcommand*{\cftpartformatpnum}[1]{%
	    \hbox to\unitlength{{\cftpartpagefont ####1}}}
	  \let\oldcftbookformatpnum\cftbookformatpnum
	  \renewcommand*{\cftbookformatpnum}[1]{%
	    \hbox to\unitlength{{\cftbookpagefont ####1}}}}

	\renewcommand*{\setupparasubsecs}{%
	  \@shorttocfalse
	  \let\oldnumberline\numberline
	  \renewcommand*{\cftsubsectionfont}{\itshape}
	  \renewcommand*{\cftsubsectionpagefont}{\itshape}
	  \renewcommand{\l@subsection}[2]{
	    \ifnum\c@tocdepth > 1\relax
	      \def\numberline########1{\textit{########1}~}%
	      \leftskip=\cftsubsectionindent
	      \rightskip=\@tocrmarg
	      % \advance\rightskip 0pt plus \hsize % uncomment this for raggedright
	      % \advance\rightskip 0pt plus 2em    % uncomment this for semi-ragged
	      \parfillskip=\fill
	      \ifhmode
	        \unskip\unskip\unskip\unskip\unskip\unskip\unskip\unskip%
	        \unskip\unskip\unskip\unskip\unskip\unskip\unskip\unskip%
	        \,,\space\space\space\space
	      \else
	        \noindent
	      \fi
	      \ignorespaces 
	      {\cftsubsectionfont \S\,####1}~~~{\cftsubsectionpagefont####2}%
	       \let\numberline\oldnumberline\ignorespaces
	    \fi}
	}

	\AtEndDocument{\addtocontents{toc}{\par}}%%% OK

	%%   - Define long TOC
	\renewcommand*{\setupmaintoc}{%
	  \renewcommand{\contentsname}{Contents}
	  \let\changetocdepth\oldchangetocdepth
	  \let\precistoctext\oldprecistoctext
	  \let\cftchapterfillnum\oldcftchapterfillnum
	  \addtodef{\cftchapterbreak}{\par}{}
	  \renewcommand*{\cftchapterfont}{\normalfont\sffamily}
	  \renewcommand*{\cftchapterleader}{\sffamily\cftdotfill{\cftchapterdotsep}}
	  \renewcommand*{\cftchapterafterpnum}{}
	  \renewcommand{\cftchapterbreak}{\par\addpenalty{-\@highpenalty}}
	  % \renewcommand{\cftsectionname}{\S\,}
	  % \renewcommand{\cftsubsectionname}{\S\,}
	  \setpnumwidth{2.55em}
	  \setrmarg{3.55em}
	  \setcounter{tocdepth}{2}
	  \let\cftpartformatpnum\oldcftpartformatpnum
	  \addtodef{\cftpartbreak}{\par}{}
	  \let\cftbookformatpnum\oldcftbookformatpnum
	  \addtodef{\cftbookbreak}{\par}{}
	}
\fi

}

%% * Print TOC
%%   - Short TOC
\newcommand{\printshorttoc}{%
	\setupshorttoc
	\ifsuacse@toc@short@show
		\if@suacse@toc@toc@show \tableofcontents \else \tableofcontents* \fi
		% \clearpage
	\fi
}
\newcommand{\printmaintoc}{%
	%% - Setup short TOC at the begin
	\setupshorttoc
	%% - Setup main TOC, note that some commands are defined in the short toc
	%%   so that don't forget to load it first.
	\setupparasubsecs
	\setupmaintoc
	\if@suacse@toc@toc@show \tableofcontents \else \tableofcontents* \fi
	% \clearpage
}


%% END: TOC etc.
%% ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++


%% ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
%% Created by Dazhi Jiang, 2010-11-16 16:10:58 +0000 (Tue, 16 Nov 2010)
%% Chapter Styling

%% * Declare switchers for the extra chapter styles
\newif\if@suacse@chapterstyle@daleifi
\newif\if@suacse@chapterstyle@GreyNum
\newif\if@suacse@chapterstyle@texblogtikz
\newif\if@suacse@chapterstyle@acsei
\newif\if@suacse@chapterstyle@acseii
\newif\if@suacse@chapterstyle@fncychap@bjornstrup

%% * Clear chapter style
\newcommand*{\@suacse@chapterstyle@clear}{%
	\@suacse@chapterstyle@daleififalse
	\@suacse@chapterstyle@GreyNumfalse
	\@suacse@chapterstyle@texblogtikzfalse
	\@suacse@chapterstyle@acseifalse
	\@suacse@chapterstyle@acseiifalse
	\@suacse@chapterstyle@fncychap@bjornstrupfalse
}

%% * Define chapter-style-related keys
\pgfkeys{%
	/suacse/.cd,
	%% - Chapter style
	chapterstyle/.code={\chapterstyle{#1}
						\def\@suacse@chapter@style{#1}},
	chapterstyle@daleifi/.is if=@suacse@chapterstyle@daleifi,
	chapterstyle@GreyNum/.is if=@suacse@chapterstyle@GreyNum,
	chapterstyle@texblogtikz/.is if=@suacse@chapterstyle@texblogtikz,
	chapterstyle@acsei/.is if=@suacse@chapterstyle@acsei,
	loadextrachapsty/.is choice,
	loadextrachapsty/all/.code={\@suacse@chapterstyle@clear%
								\@suacse@chapterstyle@daleifitrue%
								\@suacse@chapterstyle@GreyNumtrue%
								\@suacse@chapterstyle@texblogtikztrue%
								\@suacse@chapterstyle@acseitrue%
								\@suacse@chapterstyle@acseiitrue%
								\@suacse@chapterstyle@fncychap@bjornstruptrue},
	loadextrachapsty/daleifi/.code={\@suacse@chapterstyle@clear%
									\@suacse@chapterstyle@daleifitrue},
	loadextrachapsty/GreyNum/.code={\@suacse@chapterstyle@clear%
									\@suacse@chapterstyle@GreyNumtrue},
	loadextrachapsty/texblogtikz/.code={\@suacse@chapterstyle@clear%
										\@suacse@chapterstyle@texblogtikztrue},
	loadextrachapsty/acsei/.code={\@suacse@chapterstyle@clear%
					 			  \@suacse@chapterstyle@acseitrue},
	loadextrachapsty/acseii/.code={\@suacse@chapterstyle@clear%
					 			  \@suacse@chapterstyle@acseiitrue},
	loadextrachapsty/.append code={\suacse@loadextrachapsty},
}

%% * Define chapter-style-related option keys
\pgfkeys{%
	/suacseopt/.cd,
	%% - Chapter style
	chapterstyle/.code={\suacseset{chapterstyle=#1}},
	%% - Chapter styles provided by the package 'fncychap'
	fncychap/.is choice,
	fncychap/bjornstrup/.prefix style={chapterstyle=default},
	fncychap/bjornstrup/.code={\RequirePackage[Bjornstrup]{fncychap}
							   \ChTitleVar{\raggedleft\LARGE\sffamily\bfseries}},
}

\newcommand{\@suacse@chapterhead@memoir}{%
	\def\@makeschapterhead##1{%
	  \chapterheadstart
	  {%\parindent \z@ \raggedright \normalfont
	   \parindent \z@ \memRTLraggedright \normalfont
	   \printchapternonum
	   \interlinepenalty\@M
	   \printchaptertitle{##1}%
	   \afterchaptertitle}%
	}
}

%% ! Note that in the nested \newcommand command, #1 is the first argument
%%   for the most outer one, and ##1 is the first argument for the next less
%%   outer one.
\newcommand{\suacse@loadextrachapsty}{%
\if@suacse@chapterstyle@daleifi
	% \RequirePackage{color,calc,graphicx,soul}
	% \RequirePackage{graphicx}
	\definecolor{nicered}{rgb}{.647,.129,.149}
	\newlength\dlf@normtxtw
	\setlength\dlf@normtxtw{\textwidth}
	\def\myhelvetfont{\def\sfdefault{mdput}}
	\newsavebox{\feline@chapter}
	\newcommand\feline@chapter@marker[1][4cm]{%
	  \sbox\feline@chapter{%
	    \resizebox{!}{##1}{\fboxsep=1pt%
	      \colorbox{nicered}{\color{white}\bfseries\sffamily\thechapter}%
	    }}%
	  \rotatebox{90}{%
	    \resizebox{%
	      \heightof{\usebox{\feline@chapter}}+\depthof{\usebox{\feline@chapter}}}%
	    {!}{\scshape\so\@chapapp}}\quad%
	  \raisebox{\depthof{\usebox{\feline@chapter}}}{\usebox{\feline@chapter}}% 
	}
	\newcommand\feline@chm[1][4cm]{%
	  \sbox\feline@chapter{\feline@chapter@marker[##1]}%
	  \makebox[0pt][l]{% aka \rlap
	    \makebox[1cm][r]{\usebox\feline@chapter}%
	  }}
	\makechapterstyle{daleifi}{
	  \chapterstyle{default}
	  \renewcommand\chapnamefont{\normalfont\Large\scshape\raggedleft\so}
	  \renewcommand\chaptitlefont{\normalfont\huge\bfseries\scshape\color{nicered}}
	  \renewcommand\chapternamenum{}
	  \renewcommand\printchaptername{}
	  \renewcommand\printchapternum{\null\hfill\feline@chm[2.5cm]\par}
	  \renewcommand\afterchapternum{\par\vskip\midchapskip}
	  \renewcommand\printchaptertitle[1]{\chaptitlefont\raggedleft ####1\par}
	}
\fi
\if@suacse@chapterstyle@GreyNum
	% \RequirePackage{fix-cm}
	% \RequirePackage{fourier}%................... Roman+math - Utopia
	% \RequirePackage{color}
	\definecolor{ChapGrey}{rgb}{0.6,0.6,0.6}
	\newcommand{\LargeFont}{% Needs a 'stretchable' font
	      \usefont{\encodingdefault}{\rmdefault}{b}{n}%
	      \fontsize{60}{80}\selectfont\color{ChapGrey}}
	\makechapterstyle{GreyNum}{%
	  \chapterstyle{default}
	  \renewcommand{\chapnamefont}{\large\sffamily\bfseries\itshape}
	  \renewcommand{\chapnumfont}{\LargeFont}
	  \renewcommand{\chaptitlefont}{\Huge\sffamily\bfseries\itshape}
	  \setlength{\beforechapskip}{0pt}
	  \setlength{\midchapskip}{40pt}
	  \setlength{\afterchapskip}{60pt}
	  \renewcommand\chapterheadstart{\vspace*{\beforechapskip}}
	  \renewcommand\printchaptername{%
	    \begin{tabular}{@{}c@{}}
	      \chapnamefont \@chapapp\\}
	    \renewcommand\chapternamenum{\noalign{\vskip 2ex}}
	    \renewcommand\printchapternum{\chapnumfont\thechapter\par}
	    \renewcommand\afterchapternum{%
	    \end{tabular}
	    \par\nobreak\vskip\midchapskip}
	  \renewcommand\printchapternonum{}
	  \renewcommand\printchaptertitle[1]{%
	    {\chaptitlefont{####1}\par}}
	  \renewcommand\afterchaptertitle{\par\nobreak\vskip \afterchapskip}
	}
\fi
\newif\ifnumberedchap
\numberedchaptrue
\if@suacse@chapterstyle@texblogtikz
	% \newif\iftestii
	% \testiitrue
	% \iftestii
	% 	\typeout{iftestii is true.}
	% \else
	% 	\typeout{iftestii is false.}
	% \fi
	% \typeout{done!}
	% \RequirePackage[svgnames]{xcolor}
	% \RequirePackage{tikz}
	%% helper macros
	\newcommand{\ChapWithNumber}[1]{
	\begin{tikzpicture}[remember picture,overlay]
	    \node[yshift=-3cm] at (current page.north west)
	      {\begin{tikzpicture}[remember picture, overlay]
	        \draw[fill=LightSkyBlue] (0,0) rectangle
	          (\stockwidth,3cm);
	        \node[anchor=east,xshift=.9\stockwidth,rectangle,
	              rounded corners=20pt,inner sep=11pt,
	              fill=MidnightBlue]
	              {\color{white}\chapnamefont\thechapter\space ##1};
	       \end{tikzpicture}
	      };
	   \end{tikzpicture}
	}
	\newcommand{\ChapWithoutNumber}[1]{
	  \begin{tikzpicture}[remember picture,overlay]
	    \node[yshift=-3cm] at (current page.north west)
	    {\begin{tikzpicture}[remember picture, overlay]
	        \draw[fill=LightSkyBlue] (0,0) rectangle
	        (\stockwidth,3cm);
	        \node[anchor=east,xshift=.9\stockwidth,rectangle,
	        rounded corners=20pt,inner sep=11pt,
	        fill=MidnightBlue]
	        {\color{white}\chapnamefont##1};
	      \end{tikzpicture}
	    };
	  \end{tikzpicture}
	}
	% \newif\ifnumberedchap
	% \numberedchaptrue
	\makechapterstyle{texblogtikz}{
	  \chapterstyle{default}
	  \renewcommand\chapnamefont{\normalfont\sffamily\Huge\bfseries}
	  \renewcommand\chapnumfont{\normalfont\sffamily\Huge\bfseries}
	  \renewcommand\chaptitlefont{\normalfont\sffamily\Huge\bfseries}
	  \renewcommand\chapternamenum{}
	  \renewcommand{\afterchapternum}{}
	  \renewcommand\printchaptername{}
	  \renewcommand\printchapternum{}
	  \renewcommand\printchapternonum{\global\numberedchapfalse}
	  \renewcommand\printchaptertitle[1]{%
	    \ifnumberedchap
	    \ChapWithNumber{####1}
	    \else
	    \ChapWithoutNumber{####1}
	    \fi
	    \global\numberedchaptrue
	  }
	}
\fi
\if@suacse@chapterstyle@acsei
	% \RequirePackage{xcolor}  % Load Package 'xcolor'
	% \RequirePackage{tikz}  % Load Package 'tikz'
	% \providecommand\thesispage{\normalfont p.\,\thepage}
	% \providecommand\thesispage{\normalfont \colorbox{gray}%
	% 				{\color{white}p.\,\thepage}}
	% \providecommand\thesispage{\normalfont \tikz[baseline=0pt] %
	% 		\node[fill=black!75,text=white,anchor=base] {p.\,\thepage};}
	% \setlength{\headheight}{\baselineskip}
	% \setlength{\headwidth}{\textwidth+\marginparsep+0.5\marginparwidth}
	\makechapterstyle{acsei}{%
	  \chapterstyle{default}
	  \setlength\beforechapskip{0pt}
	  \setlength\midchapskip{0pt}
	  \setlength\afterchapskip{40pt}
	  \renewcommand\chapnamefont{%
	    \normalfont\centering\large\scshape\MakeLowercase}
	  \renewcommand\chapnumfont{%
	    \normalfont\centering\fontsize{60pt}{0pt}\selectfont}
	  \renewcommand\chaptitlefont{%
	    \normalfont\HUGE\bfseries\centering}
	  \renewcommand\printchaptername{%
	    \marginpar{\chapnamefont{\@chapapp}}}
	  \renewcommand\chapternamenum{}
	  \renewcommand\printchapternum{%
	    \marginpar{\chapnumfont\thechapter}}
	    % \makeoddfoot{plain}{}{\thesispage}{}
		% 	  \if@mainmatter
		% \makerunningwidth{plain}{\headwidth}
		% \makeheadposition{plain}{flushright}{flushleft}{flushright}{flushleft}
		% \makeoddfoot{plain}{}{}{\thesispage}
		% 	  \else
		% \makeoddfoot{plain}{}{}{\thepage}
		% 	  \fi
	}
\fi
\if@suacse@chapterstyle@acseii
	\gdef\@suacse@chapterstyle@acseii@chapterrule{\hrule}
	\makechapterstyle{acseii}{% requires graphicx package
	  \chapterstyle{default}
	  \renewcommand{\chapterheadstart}{%
	    \if@mainmatter%
	      \vspace*{\beforechapskip}%
	    \else%
	      \vspace*{0.1\beforechapskip}
	    \fi
	}
	  \renewcommand*{\chapnamefont}{%
	    \normalfont\Large\scshape%
	    \raggedleft}
	    % \if@mainmatter\raggedleft\fi}
	  \renewcommand*{\chaptitlefont}{%
	    \normalfont\Huge\bfseries\sffamily%
	    \raggedleft}
	    % \if@mainmatter\raggedleft\fi}
	  \renewcommand*{\chapternamenum}{}
	  \renewcommand*{\printchapternum}{%
	    \makebox[0pt][l]{\hspace{0.4em}%
	      \resizebox{!}{4ex}{%
	        \chapnamefont\bfseries\sffamily\thechapter}%
	    }%
	    \gdef\@suacse@chapterstyle@acseii@chapterrule{\hrule}
	  }%
	  \renewcommand*{\printchapternonum}{%
	    \chapnamefont \phantom{\printchaptername \chapternamenum%
	      \makebox[0pt][l]{\hspace{0.4em}%
	        \resizebox{!}{4ex}{%
	          \chapnamefont\bfseries\sffamily 1}%
	      }%
	    \gdef\@suacse@chapterstyle@acseii@chapterrule{\relax}
	    }%
	    \afterchapternum %
	  }%
	  \renewcommand*{\afterchapternum}{%
	    \par\hspace{1.5cm}%
	    % \if@mainmatter\@ifstar{\relax}{\hrule}\fi%
	    \if@mainmatter\@suacse@chapterstyle@acseii@chapterrule\fi%
	    \vskip\midchapskip}}
	    % \par\hspace{1.5cm}\hrule\vskip\midchapskip}}
\fi
}

%% END: Chapter Styling
%% ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++


%% ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
%% Created by Dazhi Jiang, 2010-11-16 16:11:38 +0000 (Tue, 16 Nov 2010)
%% Section, etc., Styling

%% Set the default section number depth
\maxsecnumdepth{subsection} % number  subsections

%% * Define section-head-style-related keys
\pgfkeys{%
	/suacse/.cd,
	%% - Section head style
	headstyle/.code={\headstyles{#1}
					 \chapterstyle{\@suacse@chapter@style}},
	makeheadstyle/.code 2 args={\makeheadstyles{#1}{#2}},
	loadheadstyle/.is choice,
	loadheadstyle/memsty/.code={\suacse@loadheadstyle@memsty},
	loadheadstyle/wspr/.code={\suacse@loadheadstyle@wspr},
	loadheadstyle/acsei/.code={\suacse@loadheadstyle@acsei},
	secnumdepth/.code={\setsecnumdepth{#1}},
	maxsecnumdepth/.code={\maxsecnumdepth{#1}},
}

%% * Define section-head-style-related options keys


%% 
\newcommand{\suacse@loadheadstyle@memsty}{%
	\makeheadstyles{memsty}{%
		\defaultsecnum
		\memmansecheads
	}
}


\newcommand{\suacse@loadheadstyle@wspr}{%
	\newcommand\marginnum[2]{%
	  \noindent
	  \let\@tempa\relax
	  \savebox\@tempboxa{##2}%
	  %\null\marginpar{#1\@tempa}%
	  ##1\@tempa\quad##2}
	
	\makeheadstyles{wspr}{%
		\defaultsecheads
	
		\def\secstyle{\centering\scshape}
		\def\subsecstyle{\centering\itshape}
		\def\subsubsecstyle{\centering\small\itshape}
	
		\setsecheadstyle{\marginnum\secstyle}
		\setsubsecheadstyle{\marginnum\subsecstyle}
		\setsubsubsecheadstyle{\marginnum\subsubsecstyle}
	
		\setsecnumformat{\unexpanded{%
		  \protected@xdef\@tempa{{\upshape\S \csname the####1\endcsname}}}}
	}
}


\newcommand{\suacse@loadheadstyle@acsei}{%
	\newcommand\marginnum[2]{%
	  \noindent
	  \let\@tempa\relax
	  \savebox\@tempboxa{##2}%
	  %\null\marginpar{#1\@tempa}%
	  ##1\@tempa##2}
	\makeheadstyles{acsei}{%
		\defaultsecnum
		
		\def\secstyle{\Large\bfseries\raggedright}
		\def\subsecstyle{\large\bfseries\raggedright}
		\def\subsubsecstyle{\bfseries\raggedright}
	
		\setsecheadstyle{\normalfont\marginnum\secstyle}
		\setsubsecheadstyle{\normalfont\marginnum\subsecstyle}
		\setsubsubsecheadstyle{\normalfont\marginnum\subsubsecstyle}
		  \setsubsubsecindent{0pt}
		
		\setsecnumformat{\unexpanded{%
		  \protected@xdef\@tempa{{\upshape\S\,\csname the####1\endcsname\quad}}}}
	}
}
%% !!! A few comment
%% The original command \marginnum puts the \quad into \@tempa. This can cause
%% unexpected extra spaces when print the unnumbered section head. The solution
%% is to move \quad to the definition of \@seccntformat which can be changed
%% using \setsecnumformat


%% * Command used to set the default head style
\newcommand*{\defaultsecheads}{
  \defaultsecnum
  \setsecheadstyle{\normalfont\Large\bfseries\raggedright}
    \setsecindent{0pt}
    \setbeforesecskip{-3.5ex plus -1ex minus -.2ex}
    \setaftersecskip{2.3ex plus .2ex}
  \setsubsecheadstyle{\normalfont\large\bfseries\raggedright}
    \setsubsecindent{0pt}
    \setbeforesubsecskip{-3.25ex plus -1ex minus -.2ex}
    \setaftersubsecskip{1.5ex plus .2ex}
  \setsubsubsecheadstyle{\normalfont\bfseries\raggedright}
    \setsubsubsecindent{0pt}
    \setbeforesubsubsecskip{-3.25ex plus -1ex minus -.2ex}
    \setaftersubsubsecskip{1.5ex plus .2ex}
  \setparaheadstyle{\normalfont\bfseries}
    \setparaindent{0pt}
    \setbeforeparaskip{3.25ex plus 1ex minus .2ex}
    \setafterparaskip{-1em}
  \setsubparaheadstyle{\normalfont\bfseries}
    \setsubparaindent{0pt}
    \setbeforesubparaskip{3.25ex plus 1ex minus .2ex}
    \setaftersubparaskip{-1em}
}

%% * Memoir manual section head style
\newcommand*{\memmansecheads}{
  \setsecheadstyle{\normalfont\scshape\raggedright}
    \setsecindent{0pt}
    \setbeforesecskip{-1.333\onelineskip plus -0.5\onelineskip minus -0.5\onelineskip}
    \setaftersecskip{.667\onelineskip plus 0.1\onelineskip}
%%% surround = 2 lines (1.333/.667)
%%% surround = 1 line (.667/.333)
  \setsubsecheadstyle{\normalfont\sffamily\raggedright}
    \setsubsecindent{0pt}
    \setbeforesubsecskip{-.667\onelineskip plus -0.5\onelineskip minus -0.5\onelineskip}
    \setaftersubsecskip{0.333\onelineskip plus 0.1\onelineskip}
%%% surround = 1 line (.667/.333)
  \setsubsubsecheadstyle{\normalfont\itshape\raggedright}
    \setsubsubsecindent{0pt}
    \setbeforesubsubsecskip{-0.667\onelineskip plus -0.25\onelineskip minus -0.25\onelineskip}
    \setaftersubsubsecskip{0.333\onelineskip plus 0.1\onelineskip}
%%% no surround
  \setparaheadstyle{\normalfont\sffamily}
    \setparaindent{0pt}
    \setbeforeparaskip{1.0\onelineskip plus 0.5\onelineskip minus 0.25\onelineskip}
    \setafterparaskip{-1em}
  \setsubparaheadstyle{\normalfont\sffamily}
    \setsubparaindent{0pt}
    \setbeforesubparaskip{1.0\onelineskip plus 0.5\onelineskip minus 0.25\onelineskip}
    \setaftersubparaskip{-1em}
}


%% END: Section, etc., Styling
%% ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++


%% ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
%% Created by Dazhi Jiang, 2010-11-16 16:03:18 +0000 (Tue, 16 Nov 2010)
%% Fonts

%% * Switchers for fonts
\newif\ifsuacseopt@font@cm			% Computer Modern
\newif\ifsuacseopt@font@ppl		% Palatino
\newif\ifsuacseopt@font@memfonts	% Hybrid of Palatino and Computer Modern, memfonts

%% * Define font-related keys
\pgfkeys{%
	/suacseopt/.cd,
	%% - Font
	font@cm/.is if=suacseopt@font@cm,
	font@ppl/.is if=suacseopt@font@ppl,
	font@memfonts/.is if=suacseopt@font@memfonts,
	font/.is choice,
	font/cm/.style={font@cm=true, font@ppl=false, font@memfonts=false},
	font/ppl/.style={font@cm=false, font@ppl=true, font@memfonts=false},
	font/memfonts/.style={font@cm=false, font@ppl=false, font@memfonts=true},
	font/.default=cm,
	font/.append code={\suacseopt@setfont},
	% font/.code={\suacseset{font=#1}},
}

%% * Load the commonly-used font & symbol packages
% \RequirePackage[T1]{fontenc} % sane font encoding
% 
% \RequirePackage{textcomp} % provide lots of new symbols
% \RequirePackage{lmodern} % for sensible sans and tt font

% \renewcommand{\suacseopt@setfont}{%
\newcommand{\suacseopt@setfont}{%
	%% Palatino
	\ifsuacseopt@font@ppl
		\RequirePackage[sc,osf]{mathpazo}  % Load Package 'mathpazo'
		% \RequirePackage{mathpazo}
		\renewcommand{\rmdefault}{ppl} 
		% \renewcommand{\oldstylenums}[1]{{\fontfamily{pplj}\selectfont #1}}
	\fi
	
	%% Memoir Manual Font Style
	\ifsuacseopt@font@memfonts
		\RequirePackage{memfonts}  % Load Package 'memfonts'
	\fi
}
\@onlypreamble\suacseopt@setfont

%% * Make maths use lining numbers: (old-style look bad most-times)
\DeclareMathSymbol{0}{0}{letters}{'060}
\DeclareMathSymbol{1}{0}{letters}{'061}
\DeclareMathSymbol{2}{0}{letters}{'062}
\DeclareMathSymbol{3}{0}{letters}{'063}
\DeclareMathSymbol{4}{0}{letters}{'064}
\DeclareMathSymbol{5}{0}{letters}{'065}
\DeclareMathSymbol{6}{0}{letters}{'066}
\DeclareMathSymbol{7}{0}{letters}{'067}
\DeclareMathSymbol{8}{0}{letters}{'070}
\DeclareMathSymbol{9}{0}{letters}{'071}

%% * Use Latin Modern for other fonts
\renewcommand{\sfdefault}{lmss}
\renewcommand{\ttdefault}{lmtt}

%%   - scaled version of t1lmtt

\DeclareFontFamily{T1}{lmtt}{\hyphenchar \font\m@ne}
\DeclareFontShape{T1}{lmtt}{m}{n}
  {<-8.5> s * [1.09] ec-lmtt8 <8.5-9.5> s * [1.09] ec-lmtt9
   <9.5-11> s * [1.09] ec-lmtt10 <11-> s * [1.09] ec-lmtt12
  }{}

\DeclareFontShape{T1}{lmtt}{m}{sl}
  {<-> s * [1.09] ec-lmtto10}{}
\DeclareFontShape{T1}{lmtt}{m}{it}
  {<-> s * [1.09] ec-lmtti10}{}
\DeclareFontShape{T1}{lmtt}{m}{sc}
  {<-> s * [1.09] ec-lmtcsc10}{}
\DeclareFontShape{T1}{lmtt}{m}{scsl}
  {<-> s * [1.09] ec-lmtcso10}{}
%%%% light (l), light condensed (lc), and dark (b) variants
\DeclareFontShape{T1}{lmtt}{l}{n}
  {<-> s * [1.09] ec-lmtl10}{}
\DeclareFontShape{T1}{lmtt}{l}{sl}
  {<-> s * [1.09] ec-lmtlo10}{}
\DeclareFontShape{T1}{lmtt}{l}{it}
  {<->sub*lmtt/l/sl}{}

\DeclareFontShape{T1}{lmtt}{lc}{n}
  {<-> s * [1.09] ec-lmtlc10}{}
\DeclareFontShape{T1}{lmtt}{lc}{sl}
  {<-> s * [1.09] ec-lmtlco10}{}
\DeclareFontShape{T1}{lmtt}{lc}{it}
  {<->sub*lmtt/lc/sl}{}

\DeclareFontShape{T1}{lmtt}{b}{n}
  {<-> s * [1.09] ec-lmtk10}{}
\DeclareFontShape{T1}{lmtt}{b}{sl}
  {<-> s * [1.09] ec-lmtko10}{}
\DeclareFontShape{T1}{lmtt}{b}{it}
  {<->sub*lmtt/b/sl}{}

\DeclareFontShape{T1}{lmtt}{bx}{n}
  {<->ssub*lmtt/b/n}{}
\DeclareFontShape{T1}{lmtt}{bx}{sl}
  {<->ssub*lmtt/b/sl}{}
\DeclareFontShape{T1}{lmtt}{bx}{it}
  {<->ssub*lmtt/b/sl}{}


%%   - scaled version of t1lmss

\DeclareFontFamily{T1}{lmss}{}
\DeclareFontShape{T1}{lmss}{m}{n}
  {<-8.5> s * [1.07] ec-lmss8 <8.5-9.5> s * [1.07] ec-lmss9
   <9.5-11> s * [1.07] ec-lmss10 <11-15.5> s * [1.07] ec-lmss12
   <15.5-> s * [1.07] ec-lmss17
  }{}
\DeclareFontShape{T1}{lmss}{m}{sl}
  {<-8.5> s * [1.07] ec-lmsso8 <8.5-9.5> s * [1.07] ec-lmsso9
   <9.5-11> s * [1.07] ec-lmsso10 <11-15.5> s * [1.07] ec-lmsso12
   <15.5-> s * [1.07] ec-lmsso17
  }{}
\DeclareFontShape{T1}{lmss}{m}{it}
  {<->ssub*lmss/m/sl}{}
\DeclareFontShape{T1}{lmss}{m}{sc}
  {<->sub*lmr/m/sc}{}

%%%%%%%%%%% semibold condensed
\DeclareFontShape{T1}{lmss}{sbc}{n}
  {<-> s * [1.07] ec-lmssdc10}{}
\DeclareFontShape{T1}{lmss}{sbc}{sl}
  {<-> s * [1.07] ec-lmssdo10}{}
\DeclareFontShape{T1}{lmss}{sbc}{it}
  {<->ssub*lmss/sbc/sl}{}

%%%%%%%%%%%% bold extended
\DeclareFontShape{T1}{lmss}{bx}{n}
  {<-> s * [1.07] ec-lmssbx10}{}
\DeclareFontShape{T1}{lmss}{bx}{sl}
  {<-> s * [1.07] ec-lmssbo10}{}
\DeclareFontShape{T1}{lmss}{bx}{it}
  {<->ssub*lmss/bx/sl}{}


%% END: Fonts
%% ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++


%% ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
%% Created by Dazhi Jiang, 2010-12-27 08:47:04 +0000 (Mon, 27 Dec 2010)
%% Title Page

%% * Define indicator for the elements of title page
\newif\if@suacse@titlepage@title@isdefined
\newif\if@suacse@titlepage@author@isdefined
\newif\if@suacse@titlepage@date@isdefined
\newif\if@suacse@titlepage@degree@isdefined
\newif\if@suacse@titlepage@degreedate@isdefined
\newif\if@suacse@titlepage@collegeordept@isdefined
\newif\if@suacse@titlepage@university@isdefined
\newif\if@suacse@titlepage@supervisor@isdefined
\newif\if@suacse@titlepage@award@isdefined
\newif\if@suacse@titlepage@crest@isdefined
\newif\if@suacse@titlepage@submittedtext@isdefined
\newif\if@suacse@titlepage@place@isdefined

%% * Declare the style switchers for title page
\newif\if@suacse@titlepage@style@acsemaster
\newif\if@suacse@titlepage@style@acsei
\newif\if@suacse@titlepage@style@acseii

%% * Clear title page style
\let\@suacse@maketitle@orig\maketitle
\newcommand*{\@suacse@titlepage@style@clear}{%
	\@suacse@titlepage@style@acsemasterfalse
	\@suacse@titlepage@style@acseifalse
	\@suacse@titlepage@style@acseiifalse
	\def\maketitle{\@suacse@maketitle@orig}
}


%% * Define title-page-related keys
\pgfkeys{%
	/suacse/.cd,
	%% - Elements for title page
	title/.code={\title{#1}\@suacse@titlepage@title@isdefinedtrue},
	author/.code={\author{#1}\@suacse@titlepage@author@isdefinedtrue},
	date/.code={\date{#1}\@suacse@titlepage@date@isdefinedtrue},
	degree/.code={\degree{#1}\@suacse@titlepage@degree@isdefinedtrue},
	degreedate/.code={\degreedate{#1}\@suacse@titlepage@degreedate@isdefinedtrue},
	collegeordept/.code={\collegeordept{#1}\@suacse@titlepage@collegeordept@isdefinedtrue},
	university/.code={\university{#1}\@suacse@titlepage@university@isdefinedtrue},
	supervisor/.code={\supervisor{#1}\@suacse@titlepage@supervisor@isdefinedtrue},
	award/.code={\award{#1}\@suacse@titlepage@award@isdefinedtrue},
	crest/.code={\crest{#1}\@suacse@titlepage@crest@isdefinedtrue},
	submittedtext/.code={\submittedtext{#1}\@suacse@titlepage@submittedtext@isdefinedtrue},
	place/.code={\place{#1}\@suacse@titlepage@place@isdefinedtrue},
	%% - Title page layout
	% titlepage/title/font/.code={\@suacse@titlepage@title@font{#1}},
	titlepage/title/font/.code={\@suacse@titlepage@element@font@define{title}{#1}},
	titlepage/title/pre/.code={\@suacse@titlepage@element@pre@define{title}{#1}},
	titlepage/title/post/.code={\@suacse@titlepage@element@post@define{title}{#1}},
	titlepage/author/font/.code={\@suacse@titlepage@element@font@define{author}{#1}},
	titlepage/author/pre/.code={\@suacse@titlepage@element@pre@define{author}{#1}},
	titlepage/author/post/.code={\@suacse@titlepage@element@post@define{author}{#1}},
	titlepage/date/font/.code={\@suacse@titlepage@element@font@define{date}{#1}},
	titlepage/date/pre/.code={\@suacse@titlepage@element@pre@define{date}{#1}},
	titlepage/date/post/.code={\@suacse@titlepage@element@post@define{date}{#1}},
	titlepage/degree/font/.code={\@suacse@titlepage@element@font@define{degree}{#1}},
	titlepage/degree/pre/.code={\@suacse@titlepage@element@pre@define{degree}{#1}},
	titlepage/degree/post/.code={\@suacse@titlepage@element@post@define{degree}{#1}},
	titlepage/degreedate/font/.code={\@suacse@titlepage@element@font@define{degreedate}{#1}},
	titlepage/degreedate/pre/.code={\@suacse@titlepage@element@pre@define{degreedate}{#1}},
	titlepage/degreedate/post/.code={\@suacse@titlepage@element@post@define{degreedate}{#1}},
	titlepage/collegeordept/font/.code={\@suacse@titlepage@element@font@define{collegeordept}{#1}},
	titlepage/collegeordept/pre/.code={\@suacse@titlepage@element@pre@define{collegeordept}{#1}},
	titlepage/collegeordept/post/.code={\@suacse@titlepage@element@post@define{collegeordept}{#1}},
	titlepage/university/font/.code={\@suacse@titlepage@element@font@define{university}{#1}},
	titlepage/university/pre/.code={\@suacse@titlepage@element@pre@define{university}{#1}},
	titlepage/university/post/.code={\@suacse@titlepage@element@post@define{university}{#1}},
	titlepage/supervisor/font/.code={\@suacse@titlepage@element@font@define{supervisor}{#1}},
	titlepage/supervisor/pre/.code={\@suacse@titlepage@element@pre@define{supervisor}{#1}},
	titlepage/supervisor/post/.code={\@suacse@titlepage@element@post@define{supervisor}{#1}},
	titlepage/award/font/.code={\@suacse@titlepage@element@font@define{award}{#1}},
	titlepage/award/pre/.code={\@suacse@titlepage@element@pre@define{award}{#1}},
	titlepage/award/post/.code={\@suacse@titlepage@element@post@define{award}{#1}},
	titlepage/crest/font/.code={\@suacse@titlepage@element@font@define{crest}{#1}},
	titlepage/crest/pre/.code={\@suacse@titlepage@element@pre@define{crest}{#1}},
	titlepage/crest/post/.code={\@suacse@titlepage@element@post@define{crest}{#1}},
	titlepage/submittedtext/font/.code={\@suacse@titlepage@element@font@define{submittedtext}{#1}},
	titlepage/submittedtext/pre/.code={\@suacse@titlepage@element@pre@define{submittedtext}{#1}},
	titlepage/submittedtext/post/.code={\@suacse@titlepage@element@post@define{submittedtext}{#1}},
	titlepage/place/font/.code={\@suacse@titlepage@element@font@define{place}{#1}},
	titlepage/place/pre/.code={\@suacse@titlepage@element@pre@define{place}{#1}},
	titlepage/place/post/.code={\@suacse@titlepage@element@post@define{place}{#1}},
	%% - Title page style
	titlepagestyle/.is choice,
	titlepagestyle/default/.code={\@suacse@titlepage@style@clear},
	titlepagestyle/acsemaster/.code={\@suacse@titlepage@style@clear %
									 \@suacse@titlepage@style@acsemastertrue %
									 \@suacse@titlepage@style@set},
	titlepagestyle/acsei/.code={\@suacse@titlepage@style@clear %
								\@suacse@titlepage@style@acseitrue
								\@suacse@titlepage@style@set},
	titlepagestyle/acseii/.code={\@suacse@titlepage@style@clear %
								 \@suacse@titlepage@style@acseiitrue
								 \@suacse@titlepage@style@set},
	titlepagestyle/.default=default,
}


%% * Define the elements of the title page
%%   - Prototype used to define the element command
\DeclareRobustCommand{\@suacse@titlepage@element@define}[1]{%
	\@namedef{#1}##1{%
		\expandafter\expandafter\expandafter\gdef\@nameuse{@suacse@titlepage@#1}{##1}}
}
%%   - Prototype used to define the element font
% \DeclareRobustCommand{\@suacse@titlepage@element@define}[1]{%
% 	\@namedef{#1}##1{%
% 		\expandafter\expandafter\expandafter\gdef\@nameuse{@suacse@titlepage@#1}{##1}}
% }
\DeclareRobustCommand{\@suacse@titlepage@element@font@define}[2]{%
	% \@suacse@titlepage@element@define{@suacse@titlepage@#1@font}
	\@namedef{@suacse@titlepage@#1@font}{\normalfont #2}
	% \expandafter\def\csname @suacse@titlepage@#1@font\endcsname ##1{##1}
	% \expandafter\long\@namedef{@suacse@titlepage@#1@font}##1{##1}
	% \expandafter\expandafter\expandafter\gdef\@nameuse{@suacse@titlepage@#1@font}{##1}
}
%%   - Prototype used to define the text before the main element
\DeclareRobustCommand{\@suacse@titlepage@element@pre@define}[2]{%
	% \@suacse@titlepage@element@define{@suacse@titlepage@#1@font}
	\@namedef{@suacse@titlepage@#1@pre}{#2}
}
%%   - Prototype used to define the text after the main element
\DeclareRobustCommand{\@suacse@titlepage@element@post@define}[2]{%
	% \@suacse@titlepage@element@define{@suacse@titlepage@#1@font}
	\@namedef{@suacse@titlepage@#1@post}{#2}
}
%%   - Prototype used to define the layout of the elements
\DeclareRobustCommand{\@suacse@titlepage@element@group@define}[1]{%
	\@namedef{@suacse@titlepage@group@#1}{%
		\@nameuse{@suacse@titlepage@#1@pre}
		{\@nameuse{@suacse@titlepage@#1@font} \@nameuse{@suacse@titlepage@#1}}
		\@nameuse{@suacse@titlepage@#1@post}
	}
}
%%     !!! Comment
%%     The definition of \@nameuse is
%%         \def\@nameuse#1{\csname #1\endcsname}
%%     The 1st \expandafter saves the 2nd one, while the 3rd one saves \gdef.
%%     Thus, the 2nd \expandafter and \gdef are saved, while \@nameuse is
%%     expanded to its definition. Then the command becomes
%%         \expandafter\gdef\csname @#1\endcsname
%%     This will allow the final expanded result is \@#1 with #1 replacing by
%%     the corresponding text.


%%   - Main title
\let\title@orig\title
\renewcommand{\title}[1]{%
	\title@orig{#1}%
	\let\@suacse@titlepage@title\@title
}
\@suacse@titlepage@element@group@define{title}

%%   - Author
\let\author@orig\author
\renewcommand{\author}[1]{%
	\author@orig{#1}%
	\let\@suacse@titlepage@author\@author
}
\@suacse@titlepage@element@group@define{author}

%%   - Date
\let\date@orig\date
\renewcommand{\date}[1]{%
	\date@orig{#1}%
	\let\@suacse@titlepage@date\@date
}
\@suacse@titlepage@element@group@define{date}

%%   - Degreedate, the year and term the degree will be officially conferred
\@suacse@titlepage@element@define{degreedate}
% \def\degreedate#1{\gdef\@degreedate{#1}}
\@suacse@titlepage@element@group@define{degreedate}

%%   - Degree, the full (unabbreviated) name of the degree
\@suacse@titlepage@element@define{degree}
% \def\degree#1{\gdef\@degree{#1}}
\@suacse@titlepage@element@group@define{degree}

%%   - collegeordept, the name of your college or department (eg. Trinity,
%%     Pembroke, Maths, Physics)
\@suacse@titlepage@element@define{collegeordept}
% \def\collegeordept#1{\gdef\@collegeordept{#1}}
\@suacse@titlepage@element@group@define{collegeordept}

%%   - University, the name of your University
\@suacse@titlepage@element@define{university}
% \def\university#1{\gdef\@university{#1}}
\@suacse@titlepage@element@group@define{university}

%%   - Supervisor, the name of your supervisor
\@suacse@titlepage@element@define{supervisor}
% \def\supervisor#1{\gdef\@supervisor{#1}}
\@suacse@titlepage@element@group@define{supervisor}

%%   - Award
\@suacse@titlepage@element@define{award}
% \def\award#1{\gdef\@award{#1}}
\@suacse@titlepage@element@group@define{award}

%%   - Defining the crest
\@suacse@titlepage@element@define{crest}
% \def\crest#1{\gdef\@crest{#1}}
\@suacse@titlepage@element@group@define{crest}

%%   - Submitted text
\@suacse@titlepage@element@define{submittedtext}
% \newcommand{\submittedtext}{{A thesis submitted for the degree of}}
\@suacse@titlepage@element@group@define{submittedtext}

%%   - Place
\@suacse@titlepage@element@define{place}
% \newcommand{\submittedtext}{{A thesis submitted for the degree of}}
\@suacse@titlepage@element@group@define{place}


%% * Set up the title page style
\newenvironment{alwayssingle}{%
	\@restonecolfalse
	\if@twocolumn \@restonecoltrue\onecolumn
	\else \newpage
	\fi}
{\if@restonecol\twocolumn\else\newpage\fi}

\newcommand{\@suacse@titlepage@style@set}{%
	%% - ACSE master style
	\if@suacse@titlepage@style@acsemaster
		\suacseset{%
			titlepage/title/font={\Huge\bfseries},
			titlepage/title/pre={\vspace*{\stretch{0.05}}},
			% titlepage/title/pre={},
			titlepage/title/post={\\},
			titlepage/crest/font={\LARGE},
			titlepage/crest/pre={\vspace*{\stretch{2.1}}},
			titlepage/crest/post={\\},
			titlepage/author/font={\LARGE\bfseries},
			titlepage/author/pre={\vspace*{\stretch{1.4}}},
			titlepage/author/post={\\},
			titlepage/award/pre={},
			titlepage/award/font={\large},
			titlepage/award/post={\\},
			titlepage/degreedate/font={\large},
			titlepage/degreedate/pre={},
			titlepage/degreedate/post={\\},
			titlepage/supervisor/font={\large},
			titlepage/supervisor/pre={\vspace*{\stretch{0.4}}},
			titlepage/supervisor/post={\\},
			titlepage/collegeordept/font={\large},
			titlepage/collegeordept/pre={},
			titlepage/collegeordept/post={\\},
			titlepage/university/font={\large},
			titlepage/university/pre={},
			titlepage/university/post={\\},
			titlepage/submittedtext/font={},
			titlepage/submittedtext/pre={\vspace*{\stretch{1}}},
			titlepage/submittedtext/post={\\},
			titlepage/degree/font={\itshape},
			titlepage/degree/pre={},
			titlepage/degree/post={\vspace*{\stretch{0.4}}},
		}
		\renewcommand{\maketitle}{%
			\begin{alwayssingle}
				\thispagestyle{empty}
				% \null\vfill
				\begin{DoubleSpace}
				\begin{center}
					%% - Main title
					\@suacse@titlepage@group@title
					%% - Crest
					\@suacse@titlepage@group@crest
					%% - Author
					\@suacse@titlepage@group@author
					%% - Award
					\@suacse@titlepage@group@award
					%% - Degree date
					\@suacse@titlepage@group@degreedate
					%% - Supervisor
					\@suacse@titlepage@group@supervisor
					%% - College or department
					\@suacse@titlepage@group@collegeordept
					%% - University
					\@suacse@titlepage@group@university
					%% - Submitted text
					\@suacse@titlepage@group@submittedtext
					%% - Degree
					\@suacse@titlepage@group@degree
				\end{center}
				\end{DoubleSpace}
				% \null\vfill
			\end{alwayssingle}
		}
	\fi
	%% - ACSE style I
	\if@suacse@titlepage@style@acsei
		\suacseset{%
			titlepage/title/font={\Huge\bfseries},
			titlepage/title/pre={\vspace*{\stretch{0.02}}},
			% titlepage/title/pre={},
			titlepage/title/post={\\},
			titlepage/crest/font={\LARGE},
			titlepage/crest/pre={\vspace*{\stretch{1.1}}},
			titlepage/crest/post={\\},
			titlepage/author/font={\LARGE\bfseries},
			titlepage/author/pre={\vspace*{\stretch{0.5}}{\LARGE BY}\\ \vspace*{\stretch{0.4}}},
			titlepage/author/post={\\},
			titlepage/award/pre={},
			titlepage/award/font={\large},
			titlepage/award/post={\\},
			titlepage/degreedate/font={\normalfont},
			titlepage/degreedate/pre={},
			titlepage/degreedate/post={\vspace*{\stretch{0.2}}},
			titlepage/supervisor/font={\large},
			titlepage/supervisor/pre={\vspace*{\stretch{0.9}}},
			titlepage/supervisor/post={\\},
			titlepage/collegeordept/font={\large},
			titlepage/collegeordept/pre={},
			titlepage/collegeordept/post={\\},
			titlepage/university/font={\normalfont},
			titlepage/university/pre={},
			titlepage/university/post={\unskip,~\ignorespaces},
			titlepage/place/font={\normalfont},
			titlepage/place/pre={},
			titlepage/place/post={\unskip,~\ignorespaces},
			titlepage/submittedtext/font={\normalfont},
			titlepage/submittedtext/pre={\vspace*{\stretch{1}}},
			titlepage/submittedtext/post={\\},
			titlepage/degree/font={\normalfont\itshape},
			titlepage/degree/pre={},
			titlepage/degree/post={\\},
		}
		\renewcommand{\maketitle}{%
			\begin{alwayssingle}
				\thispagestyle{empty}
				% \null\vfill
				\begin{DoubleSpace}
				\begin{center}
					%% - Main title
					\@suacse@titlepage@group@title
					%% - Author
					\@suacse@titlepage@group@author
					%% - Crest
					\@suacse@titlepage@group@crest
					%% - Award
					% \@suacse@titlepage@group@award
					%% - Supervisor
					\@suacse@titlepage@group@supervisor
					%% - College or department
					\@suacse@titlepage@group@collegeordept
					%% - Submitted text
					\@suacse@titlepage@group@submittedtext
					%% - Degree
					\@suacse@titlepage@group@degree
					%% - University
					% \@suacse@titlepage@group@university
					%% - Place
					\@suacse@titlepage@group@place
					%% - Degree date
					\@suacse@titlepage@group@degreedate
				\end{center}
				\end{DoubleSpace}
				% \null\vfill
			\end{alwayssingle}
		}
	\fi
	%% - ACSE style II
	\if@suacse@titlepage@style@acseii
	
	\fi
}

% \newcommand{\submittedtext}{{A thesis submitted for the degree of}}
% \newcommand{\submittedtext}{A dissertation submitted in partial fulfilment of the requirements for the degree of}

%% END: Title Page
%% ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++


%% ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
%% Created by Dazhi Jiang, 2010-12-26 03:29:14 +0000 (Sun, 26 Dec 2010)
%% Glossary

%% * Glossaries
%%   The package 'glossaries' provides many advanced features. The following
%%   part is used to define the style of glossary using this package.

%% * Define keys for glossaries
\pgfkeys{%
	/suacse/.cd,
	%% - Options for glossaries
	glossaries/settings/.is choice,
	glossaries/settings/acsei/.code={\@suacse@glossaries@setting@acsei},
	glossaries/entryname/pgf/.code 2 args={\@suacse@glossaries@entryname@pgf[#1]{#2}},
}


%% * Define package option keys for glossaries
\pgfkeys{%
	/suacseopt/.cd,
	%% - Options for glossaries
	glossariesopt/.code={\@suacse@glossaries@option@setup{#1}},
	% hyperrefopt/.store in=\@suacse@hyperref@option,
	glossaries@opt@acsei/.style={glossariesopt=\@suacse@glossaries@opt@acsei},
}

%% * Commands required by key /suacse/hyperrefopt
\newif\if@suacse@glossaries@option@predefined
\newcommand{\@suacse@glossaries@option@setup}[1]{%
	\@suacse@glossaries@option@predefinedfalse
	\nametest{#1}{acsei}
	\ifsamename
		\suacse@opt@set{glossaries@opt@acsei}
		\samenamefalse
		\@suacse@glossaries@option@predefinedtrue
	\fi
	\if@suacse@glossaries@option@predefined \else
		\def\@suacse@glossaries@option{#1}
	\fi
}

%% * Initialise the glossaries options
\def\@suacse@glossaries@option{}

\def\@suacse@glossaries@opt@acsei{acronym,%
								  style=long3colheader,%
								  toc,%
								  section,%
								  }

%% * Configure the glossaries
%%   - ACSEI style
%%     The following command sets up the glossaries for SUACSEThesis
\newcommand{\@suacse@glossaries@setting@acsei}{%
	\@ifpackageloaded{glossaries}%
		{\let\endsuacsethesis\relax}%
		{\let\endsuacsethesis\endinput %
		\PackageError{SUACSEThesis}{Forget to load the glossaries package?}{\@ehd}}
	\endsuacsethesis
	
	%% - Set up the glossary entry style. 
	%%   Note that,
	%%   1. This style only works with the option 'long3col*'.
	%%   2. The package 'biblatex' has to be loaded before this command is
	%%      invoked, because it contains a command, \MakeCapital, which is
	%%      defined in the package 'biblatex'.
	% \renewcommand*{\glossaryentryfield}[5]{%
	% 	\glstarget{####1}{####2} & \MakeCapital{####3} & ####5\\}%
	
	\setlength{\glsdescwidth}{0.58\textwidth}
	\setlength{\glspagelistwidth}{0.15\textwidth}
	
	% \newglossary[nlg]{symbols}{not}{ntn}{Symbols}
	\makeglossaries
	% \loadglsentries{database1}
	% \loadglsentries[symbols]{database2}
	
	\renewcommand*{\glsgroupskip}{}
}

%% * Commands for glossaries
%%   - Change entry name
\newcommand*{\@suacse@glossaries@entryname@pgf}[2][2cm]{%
	\renewcommand*{\entryname}{%
		\tikz[baseline=0pt]%
		\node[anchor=base, text width=#1, align=flush left, inner sep=0pt] %
			{#2};}
}


%% * Settings using the original 'glossary' support in memoir.

%% * Define switcher for glossary
\newif\if@suacse@glossary@make
\newif\if@suacse@glossary@style@twocolumn


%% * Define keys for glossary
\pgfkeys{%
	/suacse/.cd,
	%% - Options for glossary
	glossary/twocolumn/.is if=@suacse@glossary@style@twocolumn,
	glossary/twocolumn/.default=true,
	glossary/twocolumn/.append code={%
						\if@suacse@glossary@style@twocolumn
							\twocolglossary
							% \show\columnwidth
						\else
							\onecolglossary
						\fi},
	glossary/column sep/.code={\setlength{\glossarycolsep}{#1}},
	glossary/rule width/.code={\setlength{\glossaryrule}{#1}},
	glossary/name/.code={\renewcommand*{\glossaryname}{#1}},
	glossary/term/.code={\renewcommand{\memgloterm}[1]{#1}},
	glossary/description/.code={\renewcommand{\memglodesc}[1]{#1}},
	glossary/ref/.code={\renewcommand{\memgloref}[1]{#1}},
	glossary/number/.code={\renewcommand{\memglonum}[1]{#1}},
	glossary/number format/.code={\renewcommand{\suacseglossnumformat}[1]{#1}},
	glossary/group heading format/.code={\def\@suacse@glossary@heading@format{#1}},
	% glossary/group heading/add/.code 2 args={%
	% 	\show\@suacse@glossary@heading@group@oldname
	% 	\edef\@suacse@glossary@heading@group@oldname{%
	% 		\@suacse@glossary@heading@group@oldname @old}
	% 	\show\@suacse@glossary@heading@group@oldname
	% 	\expandafter\expandafter\expandafter\let%
	% 		\@nameuse{\@suacse@glossary@heading@group@oldname}%
	% 		\@suacse@glossary@heading@group
	% 	\renewcommand{\@suacse@glossary@heading@group}[1]{%
	% 		\@nameuse{\@suacse@glossary@heading@group@oldname}{##1}
	% 		\@suacse@glossary@heading@group@mask{##1}{#1}{#2}
	% 	}\show\@suacse@glossary@heading@group},
	glossary/group heading/add/.code 2 args={%
		\@suacse@glossary@heading@group@add{#1}{#2}},
	glossary/.code={\pgfkeys{/suacse/glossary/.cd, #1}},
	glossary/pagestyle/.code={#1},
}

% {\cftKfont {\cftKname \cftKpresnum SNUM\cftKaftersnum\hfil} \cftKaftersnumb TITLE} {\cftKleader}{\cftKformatpnum{PAGE}}\cftKafterpnum\par
% \gdef\suacseglossnumformat#1{\textbf{\hyperpage{#1}}}
% \def\suacseglossnumformat#1{#1}
\newcommand{\suacseglossnumformat}[1]{#1}

% %%%%%% hypermarks in index
% %    from email from Lars Madsen
% \providecommand{\doglobookmark}[1]{{\def\@tempa{Symbols}\def\@tempb{#1}%
%   \centering\bfseries \ifx\@tempa\@tempb @ \else #1\fi\vskip\onelineskip\par}}
% % extended to add booksmarks for each letter group.
% \renewcommand{\doglobookmark}[1]{{\def\@tempa{Symbols}\def\@tempb{#1}%
%   \centering\bfseries \ifx\@tempa\@tempb %
%   Analphabetics 
%   \phantomsection%
%   \pdfbookmark[0]{Analphabetics}{Analphabetics-glo}%
% %  \label{AnalphabeticsAnalphabeticsAnalphabetics-idx}%
%   \else 
%   #1%
%   \phantomsection%
%   \pdfbookmark[1]{#1}{#1-glo}%
% %  \label{#1#1#1-idx}%
%   \fi%
%   \vskip\onelineskip\par}}

%%%%%% hypermarks in index
%    from email from Lars Madsen
\providecommand{\doglobookmark}[1]{%
	{\def\@tempa{Symbols}\def\@tempb{#1}%
	\centering\bfseries 
	\ifx\@tempa\@tempb @ \else #1\fi\vskip\onelineskip\par}}

%% * Define the formats of the glossary group headings
\let\@suacse@glossary@heading@format\relax

%% * Define the glossary group headings according their keys
\newcommand{\@suacse@glossary@heading@group@mask}[3]{%
	\nametest{#1}{#2}
	\ifsamename
		\def\@suacse@glossary@heading{#3}
		\samenamefalse
	\fi
	\@ifnextchar\bgroup
		{\@suacse@glossary@heading@group@mask{#1}}
		{\relax}
}

\newcommand{\@suacse@glossary@heading@group}[1]{%
	\def\@suacse@glossary@heading{#1}
}

%% * Redefine the glossary headings as desired.
\renewcommand{\@suacse@glossary@heading@group}[1]{%
	% \def\@suacse@glossary@heading{Miscellaneous}
	\@suacse@glossary@heading@group@mask{#1}{C}{Constants, Variables \& Functions}%
											{E}{Operators}%
											{N}{Notation}%
											{T}{Acronyms/Terminology}%
											{Z}{{Miscellaneous}}
}


% \edef\@suacse@glossary@heading@group@oldname{@suacse@glossary@heading@group}

% \newcommand{\@suacse@glossary@heading@group@add}[2]{%
% 	% \show\@suacse@glossary@heading@group@oldname
% 	\edef\@suacse@glossary@heading@group@oldname{%
% 		\@suacse@glossary@heading@group@oldname @old}
% 	% \show\@suacse@glossary@heading@group@oldname
% 	\expandafter\expandafter\expandafter\let\@nameuse{\@suacse@glossary@heading@group@oldname}=\@suacse@glossary@heading@group
% 	% \@namedef{\@suacse@glossary@heading@group@oldname}##1{\@suacse@glossary@heading@group{##1}}
% 	\show\@suacse@glossary@heading@group
% 	\renewcommand{\@suacse@glossary@heading@group}[1]{%
% 		\@nameuse{\@suacse@glossary@heading@group@oldname}{##1}
% 		\@suacse@glossary@heading@group@mask{##1}{#1}{#2}
% 	}
% 	% \show\@suacse@glossary@heading@group
% }

% \@suacse@glossary@heading@group@add{E}{Operators}
% \show\@suacse@glossary@heading@group@old
% \@suacse@glossary@heading@group@add{N}{Notation}
% \show\@suacse@glossary@heading@group@old
% \show\@suacse@glossary@heading@group@old@old

% % \newcommand{\@suacse@glossary@heading@group@old}[1]{\@suacse@glossary@heading@group{#1}}
% \let\@suacse@glossary@heading@group@old\@suacse@glossary@heading@group
% % \edef\@suacse@glossary@heading@group@old[#1]{\@suacse@glossary@heading@group{#1}}
% % \edef\@suacse@glossary@heading@group@old#1{\@suacse@glossary@heading@group{#1}}
% 
% \edef\@suacse@test@tmpa{@suacse@glossary@heading@group}
% \edef\@suacse@test@tmpa{\@suacse@test@tmpa @old}
% \expandafter\expandafter\expandafter\let\@nameuse{\@suacse@test@tmpa}\@suacse@glossary@heading@group

% \renewcommand{\@suacse@glossary@heading@group}[1]{%
% 	\@nameuse{\@suacse@test@tmpa}{#1}
% 	\@suacse@glossary@heading@group@mask{#1}{E}{Operators}
% }
% 
% % \def\@suacse@glossary@heading@group@old{\@empty}
% % \def\@suacse@test@tmpa{@suacse@glossary@heading@group@old@old}
% \edef\@suacse@test@tmpa{@suacse@glossary@heading@group}
% \edef\@suacse@test@tmpa{\@suacse@test@tmpa @old}
% % \def\@suacse@test@tmpb{}
% \let\@suacse@test@tmpb=\@suacse@test@tmpa
% \def\@suacse@test@tmpa\expandafter{\@suacse@test@tmpb @old}
% \let\@suacse@test@tmpb=\@suacse@test@tmpa
% % \def\@suacse@test@tmpa{\@suacse@test@tmpb\ignorespaces @old}
% % \show\@suacse@test@tmpa
% \expandafter\expandafter\expandafter\let\@nameuse{\@suacse@test@tmpa}\@suacse@glossary@heading@group
% \show\@suacse@test@tmpa
% \show\@suacse@glossary@heading@group@old@old
% % \renewcommand{\@suacse@glossary@heading@group@old}[1]{\@suacse@glossary@heading@group{#1}}
% % \def\@suacse@glossary@heading@group@old@old[#1]{\@suacse@glossary@heading@group{#1}}
% % \edef\@suacse@glossary@heading@group@old#1{\@suacse@glossary@heading@group{#1}}
% \renewcommand{\@suacse@glossary@heading@group}[1]{%
% 	% \@nameuse{\@suacse@test@tmpa}{#1}
% 	\@suacse@glossary@heading@group@old@old{#1}
% 	\@suacse@glossary@heading@group@mask{#1}{N}{Notation}
% }
% % \renewcommand{\@suacse@glossary@heading@group}[1]{%
% % 	\@suacse@glossary@heading@group@old{#1}
% % 	\@suacse@glossary@heading@group@mask{#1}{E}{Operators}
% % 	\@suacse@glossary@heading@group@mask{#1}{N}{Notation}
% % }



%% extended to add booksmarks for each letter group.
\renewcommand{\doglobookmark}[1]{%
	{\def\@tempa{Symbols}\def\@tempb{#1}%
	{\@suacse@glossary@heading@format %
	% \centering\bfseries %
	\ifx\@tempa\@tempb %
		Analphabetics 
		\phantomsection%
		\pdfbookmark[0]{Analphabetics}{Analphabetics-glo}%
		% \label{AnalphabeticsAnalphabeticsAnalphabetics-idx}%
	\else 
		\@suacse@glossary@heading@group{#1}
		% \ifthenelse{\equal{#1}{C}}{\def\@suacse@glossary@heading{Constants, Variables \& Functions}}{%
		% 		\ifthenelse{\equal{#1}{E}}{\def\@suacse@glossary@heading{Operators}}{%
		% 		\ifthenelse{\equal{#1}{N}}{\def\@suacse@glossary@heading{Notation}}{%
		% 		\ifthenelse{\equal{#1}{T}}{\def\@suacse@glossary@heading{Acronyms/Terminology}}%
		% 			{\def\@suacse@glossary@heading{Others}}}}}
		% #1%
		\@suacse@glossary@heading%
		\phantomsection%
		\pdfbookmark[1]{\@suacse@glossary@heading}{\@suacse@glossary@heading}%
		% \label{#1#1#1-idx}%
	\fi%
	\vskip\onelineskip\par
	}
	}
}

%% * Define package option keys for glossary
\pgfkeys{%
	/suacseopt/.cd,
	%% - Options for glossary
	makeglossary/.is if=@suacse@glossary@make,
	makeglossary/.default=true,
	makeglossary/.append code={%% * Make glossary file, glo%
								\if@suacse@glossary@make
									\makeglossary
									\changeglossactual{?}
									\changeglossnum{\thepage}
									\changeglossnumformat{|suacseglossnumformat}%% for hyperlinks
								\fi},
}


% \renewcommand{\glossitem}[4]{%
% }
%% * \glossitem{<term>}{<desc>}{<ref>}{<num>}
%%   - #1: term
%%   - #2: description
%%   - #3: reference
%%   - #4: number

%% * Make glossary file, glo
% \if@suacse@glossary@make
% 	\makeglossary
% \fi

%% END: Glossary
%% ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++


%% ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
%% Created by Dazhi Jiang, 2011-01-06 16:54:01 +0000 (Thu,  6 Jan 2011)
%% Index

%% * Define switcher for glossary
\newif\if@suacse@index@make

%% * Define package option keys for index
\pgfkeys{%
	/suacseopt/.cd,
	%% - Options for index
	makeindex/.is if=@suacse@index@make,
	makeindex/.default=true,
	makeindex/.append code={%% * Make index file, idx
							\if@suacse@index@make
								\makeindex
							\fi},
}

%% * Make index file, idx
% \if@suacse@index@make
% 	\makeindex
% \fi


%% END: Index
%% ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++


%% ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
%% Created by Dazhi Jiang, 2011-01-06 17:27:46 +0000 (Thu,  6 Jan 2011)
%% Lists

%% * List of Figure
\pgfkeys{%
	/suacse/.cd,
	lofparskip/.code={\setlength{\cftparskip}{#1}},
}

% \pgfkeys{%
% 	/suacseopt/.cd,	
% }


%% * List of Table
\pgfkeys{%
	/suacse/.cd,
	lotparskip/.code={\setlength{\cftparskip}{#1}},
}

%% END: Lists
%% ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++


%% ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
%% Created by Dazhi Jiang, 2010-11-16 16:12:36 +0000 (Tue, 16 Nov 2010)
%% Bibliography

\newif\if@suacse@mainmatter

%% * Define keys for biblatex options
\pgfkeys{%
	/suacse/.cd,
	%% - Options for biblatex
	bibname/.code={\defbibheading{bibliography}[\bibname]{%
				   \if@mainmatter\@suacse@mainmattertrue\@mainmatterfalse\fi%
				   \chapter*{#1}\addcontentsline{toc}{chapter}{#1}}%
				   \if@suacse@mainmatter\@mainmattertrue\fi},
	% bibname/.initial={References},
}

%% * Define package option keys for biblatex options
\pgfkeys{%
	/suacseopt/.cd,
	%% - Options for biblatex
	biblatexopt/.code={\@suacse@biblatex@option@setup{#1}},
	% biblatexopt/.store in=\@suacse@hyperref@option,
	biblatexopt@wspr/.style={biblatexopt={hyperref,backref,%
										  defernums,sortcites,%
										  date=short,%
										  bibencoding=inputenc,%
										  maxnames=3,%
										  minnames=2,%
										  firstinits=true,%
										  sorting=nyt,%
										  bibstyle=numeric,%
										  citestyle=numeric-comp,}},
	biblatexopt@acsei/.style={biblatexopt=\@suacse@biblatex@opt@acsei},
	% bibname/.code={\renewcommand\bibname{#1}},
}

%% * Commands required by key /suacse/hyperrefopt
\newif\if@suacse@biblatex@option@predefined
\newcommand{\@suacse@biblatex@option@setup}[1]{%
	\@suacse@biblatex@option@predefinedfalse
	\nametest{#1}{wspr}
	\ifsamename
		\suacse@opt@set{biblatexopt@wspr}
		\samenamefalse
		\@suacse@biblatex@option@predefinedtrue
	\fi
	\nametest{#1}{acsei}
	\ifsamename
		\suacse@opt@set{biblatexopt@acsei}
		\samenamefalse
		\@suacse@biblatex@option@predefinedtrue
	\fi
	\if@suacse@biblatex@option@predefined \else
		\def\@suacse@biblatex@option{#1}
	\fi
}


%%   - Initialise the biblatex options
\def\@suacse@biblatex@option{}


\def\@suacse@biblatex@opt@acsei{hyperref,backref,%
							    defernumbers,%
							    sortcites,%
							    date=short,%
							    bibencoding=inputenc,%
							    maxnames=3,%
							    minnames=2,%
							    maxcitenames=2,%
							    mincitenames=1,%
							    firstinits=true,%
							    sorting=nyt,%
							    bibstyle=numeric,%
							    citestyle=numeric-comp,%
							    backend=biber,%
							    natbib=true,%
}
%% !!! Comment
%%     The option 'defernumbers' has been disabled, since it is not compatible
%%     with the externalization library of PGF (mode = list and make).
%% 
%% !!! Update
%%     This issue can be fixed by add the following code in your preamble.
%%     \tikzifexternalizing{%
%%         \ExecuteBibliographyOptions{defernumbers=false}
%%     }{}

%% END: Bibliography
%% ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++


%% ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
%% Created by Dazhi Jiang, 2010-12-12 10:25:57 +0000 (Sun, 12 Dec 2010)
%% Hyperref Options

%% * Define keys for hyperref options
\pgfkeys{%
	/suacse/.cd,
	%% - Options for hyperref
	sethyperrefopt/.code={\hypersetup{#1}},
}


%% * Define package option keys for hyperref options
\pgfkeys{%
	/suacseopt/.cd,
	%% - Options for hyperref
	hyperrefopt/.code={\@suacse@hyperref@option@setup{#1}},
	% hyperrefopt/.store in=\@suacse@hyperref@option,
	hyperrefopt@wspr/.style={hyperrefopt={ocgcolorlinks,breaklinks,%
							plainpages=false,pdfpagelabels,linktocpage}},
	hyperrefopt@acsei/.style={hyperrefopt=\@suacse@hyperref@opt@acsei},
	hyperrefopt@djreport/.style={hyperrefopt=\@suacse@hyperref@opt@djreport},
}

%% * Commands required by key /suacse/hyperrefopt
\newif\if@suacse@hyperref@option@predefined
\newcommand{\@suacse@hyperref@option@setup}[1]{%
	\@suacse@hyperref@option@predefinedfalse
	\nametest{#1}{wspr}
	\ifsamename
		\suacse@opt@set{hyperrefopt@wspr}
		\samenamefalse
		\@suacse@hyperref@option@predefinedtrue
	\fi
	\nametest{#1}{acsei}
	\ifsamename
		\suacse@opt@set{hyperrefopt@acsei}
		\samenamefalse
		\@suacse@hyperref@option@predefinedtrue
	\fi
	\nametest{#1}{djreport}
	\ifsamename
		\suacse@opt@set{hyperrefopt@djreport}
		\samenamefalse
		\@suacse@hyperref@option@predefinedtrue
	\fi
	\if@suacse@hyperref@option@predefined \else
		\def\@suacse@hyperref@option{#1}
		% \ifxetex
		% 	\def\@suacse@hyperref@option{#1}
		% 	% \def\@suacse@hyperref@option{#1,xetex}
		% \else
		% 	\def\@suacse@hyperref@option{#1}
		% \fi
	\fi
}

%%   - Initialise the hyperref options
\def\@suacse@hyperref@option{}

\definecolor{darkred}{rgb}{0.4,0,0}
\definecolor{darkgreen}{rgb}{0,0.4,0}
\definecolor{darkblue}{rgb}{0,0,0.4}

%%   - Define the pre-defined hyperref options
%%     Since 'hyperref' can detect the latex drivers automatically, no need
%%     to specify the drivers explicitly (you can ignore the options like
%%     pdftex, dvips, xetex, etc.)
%%    
%%    !!!
%%      The option 'ocgcolorlinks' in acsei has been disabled because it is
%%      incompatible with the transparency feature of PGF/TikZ
\ifpdf
	\def\@suacse@hyperref@opt@acsei{%pdftex,%
									%ocgcolorlinks,%
									plainpages=false,%
									pdfpagelabels,%
									pdfpagelayout = OneColumn,%
									bookmarks,%
									bookmarksopen = true,%
									bookmarksnumbered = true,%
									breaklinks = true,%
									linktocpage,%
									colorlinks = true,%
									linkcolor = darkblue,%
									urlcolor  = darkblue,%
									citecolor = darkblue,%
									anchorcolor = darkgreen,%
									hyperindex = true,%
									hyperfigures}
	\def\@suacse@hyperref@opt@djreport{%pdftex,%
									   plainpages = false,%
									   pdfpagelabels,%
									   pdfpagelayout = OneColumn,%
									   bookmarks,%
									   bookmarksopen = true,%
									   bookmarksnumbered = true,%
									   breaklinks = true,%
									   linktocpage,%
									   colorlinks = true,%
									   linkcolor = blue,%
									   urlcolor  = blue,%
									   citecolor = blue,%
									   anchorcolor = green,%
									   hyperindex = true,%
									   hyperfigures}
\else
	\def\@suacse@hyperref@opt@acsei{%dvips,%
									plainpages=false,%
									bookmarks,%
									bookmarksopen = true,%
									bookmarksnumbered = true,%
									breaklinks = true,%
									linktocpage,%
									colorlinks = true,%
									linkcolor = darkblue,%
									urlcolor  = darkblue,%
									citecolor = darkblue,%
									anchorcolor = darkgreen,%
									hyperindex = true,%
									hyperfigures}
	\def\@suacse@hyperref@opt@djreport{%dvips,%
									   plainpages=false,%
									   bookmarks,%
									   bookmarksopen = true,%
									   bookmarksnumbered = true,%
									   breaklinks = true,%
									   linktocpage,%
									   colorlinks = true,%
									   linkcolor = blue,%
									   urlcolor  = blue,%
									   citecolor = blue,%
									   anchorcolor = green,%
									   hyperindex = true,%
									   hyperfigures}
\fi


%% END: Hyperref Options
%% ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++


%% ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
%% Created by Dazhi Jiang, 2011-01-05 10:19:03 +0000 (Wed,  5 Jan 2011)
%% PSTricks

%% * Define switcher for PSTricks
\newif\if@suacse@pstricks@load
\newif\if@suacse@pstricks@fig

%% * Define package option keys for PSTricks options
\pgfkeys{%
	/suacseopt/.cd,
	%% - Options for PSTricks
	pstricks/.is if=@suacse@pstricks@load,
	pstricks/.default=false,
	pstricks/.initial=false,
	pstricks/.append code={\@suacse@pstricks@load},
	pstricks/figure/.is if=@suacse@pstricks@fig,
	pstricks/figure/.default=false,
	pstricks/figure/.initial=false,
	pstricks/package/.code={#1},
}

\newcommand{\@suacse@pstricks@load}{%
	\if@suacse@pstricks@load
		\RequirePackage{pstricks}
		\RequirePackage{pst-node}
		\RequirePackage{pst-tree}
		\RequirePackage{pst-plot}
		\RequirePackage{pst-text}
		\RequirePackage{pstricks-add}
		\RequirePackage[active,tightpage]{preview}
		\PreviewEnvironment{pspicture}
		\setlength\PreviewBorder{0.1pt}
	\fi
}

%% END: PSTricks
%% ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++


%% ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
%% Created by Dazhi Jiang, 2010-12-25 16:55:49 +0000 (Sat, 25 Dec 2010)
%% PGF/TikZ

%% * Externalising
%%   - Switcher for externalising
\newif\if@suacse@pgf@externalexpensive
\let\@suacse@pgf@externalexpensivetrue@orig=\@suacse@pgf@externalexpensivetrue

%%   - Command for switching on the externalising library
%%   ! Use \@suacse@pgf@externalexpensivetrue to externalise expensive figures
\def\@suacse@pgf@externalexpensivetrue{%
	\if@suacse@pstricks@fig
		\@suacse@pgf@externalexpensivefalse
	\else
	\usepgfplotslibrary{external}
	\@suacse@pgf@externalexpensivetrue@orig
	\tikzexternalize[
		prefix=Figs/pdf/pgfexternalfig-,
		export=false, % needs to be activated for single pictures (i.e. expensive ones)
		mode=list and make,
		verbose IO=false,
		% export=true,% FASTER FOR DEBUGGING
	]
		%% !!!
		%% Changed by Dazhi Jiang - 2010-09-20
		%% The following line is commented since the new definition of
		%% \tikzexternalize in PGF 2.0 cvs
		% {pgfplots}
	\tikzifexternalizing{%
		\nofiles
	}{}%
	\fi
}%

%% ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
%% !!!
%% Modified by Dazhi Jiang, 2010-12-25 17:09:03 +0000 (Sat, 25 Dec 2010)
%% A modified alias of \@suacse@pgf@externalexpensivetrue
%% It allows to specify the main document.
\newcommand{\@suacse@pgf@externalmainfile@set}[1]{%
	\if@suacse@pstricks@fig
		\@suacse@pgf@externalexpensivefalse
	\else
	% \def\suacse@pgf@externalexpensivetrue#1{%
	\usepgfplotslibrary{external}
	\@suacse@pgf@externalexpensivetrue@orig
	\tikzexternalize[
		prefix=Figs/pdf/pgfexternalfig-,
		export=false, % needs to be activated for single pictures (i.e. expensive ones)
		mode=list and make,
		verbose IO=false,
		%xport=true,% FASTER FOR DEBUGGING
	]{#1}
		%% !!!
		%% Changed by Dazhi Jiang - 2010-09-20
		%% The following line is commented since the new definition of
		%% \tikzexternalize in PGF cvs
		% {pgfplots}
	\tikzifexternalizing{%
		\nofiles
	}{}%
	\fi
}%
%% END: A modified alias of \pgfplotsmanualexternalexpensivetrue
%% ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

\graphicspath{{Figs/pdf/}}

%%   - Switcher for the single figure externalisation
\newif\if@suacse@fig@pgf@is@expensive

% \pgfkeys{
% 	/tikz/every picture/.append code={%
% 		\if@suacse@fig@pgf@is@expensive
% 			\pgfkeys{/tikz/external/export=true}%
% 			\global\@suacse@fig@pgf@is@expensivefalse
% 		\fi
% 	}
% }

%%   - Hack 'tikzpicture' environment
% \let\@tikzpicture@orig\tikzpicture
% \def\tikzpicture{%
% 	\if@suacse@fig@pgf@is@expensive
% 		\pgfkeys{/tikz/external/export=true}%
% 		\global\@suacse@fig@pgf@is@expensivefalse
% 	\fi
% 	\@tikzpicture@orig
% }

%% Write this macro directly in front of \begin{codeexample} (without arguments):
\def\cmd@suacse@pgf@export@fig{%
	\if@suacse@pgf@externalexpensive
		\@suacse@fig@pgf@is@expensivetrue
	\else
		\message{[NOTE: I am now about to typeset an expensive example. You will need to ENLARGE YOUR TeX MEMORY CAPACITIES if this fails.]}%
	\fi
	\if@suacse@fig@pgf@is@expensive
		\pgfkeys{/tikz/external/export=true}%
		\global\@suacse@fig@pgf@is@expensivefalse
	\fi
}%

%% * Define keys for pgf externalisation
\pgfkeys{%
	/suacse/.cd,
	%% - Keys for pgf externalisation
	pgf/makeexternalfig/.code={\cmd@suacse@pgf@export@fig},
	pgf/externalprefix/.code={\tikzsetexternalprefix{#1}},
	pgf/makenextfig/.code={\cmd@suacse@pgf@export@fig\tikzsetnextfilename{#1}}
}


%% * Define package option keys for PGF/TikZ options
\pgfkeys{%
	/suacseopt/.cd,
	%% - Options for pgf externalisation
	pgf/externalising/.is if=@suacse@pgf@externalexpensive,
	pgf/externalising/.default=true,
	% pgf/externalmainfile/.code={\if@suacse@pgf@externalexpensive\@suacse@pgf@externalmainfile@set{#1}\fi},
	pgf/externalmainfile/.code={\@suacse@pgf@externalmainfile@set{#1}},
}

%% * Solve the confliction between biblatex (defernumbers) and pgf/TikZ 
%%   (externalization library)
\newcommand{\fixbiblatexpgf}{%
	\tikzifexternalizing{%
		\ExecuteBibliographyOptions{defernumbers=false}%
	}{}
}

%% END: PGF/TikZ
%% ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++


%% ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
%% Created by Dazhi Jiang, 2011-06-08 00:00:05 +0100 (Wed,  8 Jun 2011)
%% pgfplots

%% Define color themes for ggplot2-like style
%%   - GGPLOTS default theme
\definecolor[named]{ggplotDefaultBG}{rgb}{0.90,0.90,0.90}
\definecolor[named]{ggplotDefaultMajorGrid}{rgb}{1.00,1.00,1.00}
\definecolor[named]{ggplotDefaultMinorGrid}{rgb}{0.95,0.95,0.95}
\definecolor[named]{ggplotDefaultMajorTick}{rgb}{0.50,0.50,0.50}
\definecolor[named]{ggplotDefaultMinorTick}{rgb}{1.00,1.00,1.00}
\definecolor[named]{ggplotDefaultAxisBox}{rgb}{0.00,0.00,0.00}

\newlength{\ggplotDefaultMajorTickLW}
\setlength{\ggplotDefaultMajorTickLW}{0.6pt}
\newlength{\ggplotDefaultMinorTickLW}
\setlength{\ggplotDefaultMinorTickLW}{0.0pt}
\newlength{\ggplotDefaultMajorGridLW}
\setlength{\ggplotDefaultMajorGridLW}{0.6pt}
\newlength{\ggplotDefaultMinorGridLW}
\setlength{\ggplotDefaultMinorGridLW}{0.3pt}
\newlength{\ggplotDefaultAxisBoxLW}
\setlength{\ggplotDefaultAxisBoxLW}{0.3pt}

%%   - GGPLOTS black-white theme
\definecolor[named]{ggplotBWBG}{rgb}{1.00,1.00,1.00}
\definecolor[named]{ggplotBWMajorGrid}{rgb}{0.90,0.90,0.90}
\definecolor[named]{ggplotBWMinorGrid}{rgb}{0.98,0.98,0.98}
\definecolor[named]{ggplotBWMajorTick}{rgb}{0.00,0.00,0.00}
\definecolor[named]{ggplotBWMinorTick}{rgb}{1.00,1.00,1.00}
\definecolor[named]{ggplotBWAxisBox}{rgb}{0.50,0.50,0.50}

\newlength{\ggplotBWMajorTickLW}
\setlength{\ggplotBWMajorTickLW}{0.2pt}
\newlength{\ggplotBWMinorTickLW}
\setlength{\ggplotBWMinorTickLW}{0.0pt}
\newlength{\ggplotBWMajorGridLW}
\setlength{\ggplotBWMajorGridLW}{0.2pt}
\newlength{\ggplotBWMinorGridLW}
\setlength{\ggplotBWMinorGridLW}{0.6pt}
\newlength{\ggplotBWAxisBoxLW}
\setlength{\ggplotBWAxisBoxLW}{0.3pt}

%% Define theme styles
\pgfplotsset{
	SUACSEThesisPgfplotsggplot/.style = {
		tick align=outside,
		tickpos=left,
		major tick style = {color=ggplotDefaultMajorTick, 
			line width=\ggplotDefaultMajorTickLW,
			line cap=round, line join=round,
			fill opacity=0.00},
		minor tick style = {color=ggplotDefaultMinorTick, 
			line width=\ggplotDefaultMinorTickLW},
		major grid style = {color=ggplotDefaultMajorGrid, 
			line width=\ggplotDefaultMajorGridLW,
			line cap=round, line join=round,
			fill opacity=0.00},
		minor grid style = {color=ggplotDefaultMinorGrid, 
			line width=\ggplotDefaultMinorGridLW,
			line cap=round, line join=round,
			fill opacity=0.00},
		outer axis line style = {color=ggplotDefaultAxisBox, 
			line width=\ggplotDefaultAxisBoxLW,
			fill opacity=1.00},
		grid=both,
		minor tick num=1,
		axis background/.style={fill=ggplotDefaultBG},
	},
	SUACSEThesisPgfplotsggplotBW/.style = {
		tick align=outside,
		tickpos=left,
		major tick style = {color=ggplotBWMajorTick, 
			line width=\ggplotBWMajorTickLW,
			line cap=round, line join=round,
			fill opacity=0.00},
		minor tick style = {color=ggplotBWMinorTick, 
			line width=\ggplotBWMinorTickLW},
		major grid style = {color=ggplotBWMajorGrid, 
			line width=\ggplotBWMajorGridLW,
			line cap=round, line join=round,
			fill opacity=0.00},
		minor grid style = {color=ggplotBWMinorGrid, 
			line width=\ggplotBWMinorGridLW,
			line cap=round, line join=round,
			fill opacity=0.00},
		outer axis line style = {color=ggplotBWAxisBox, 
			line width=\ggplotBWAxisBoxLW,
			fill opacity=1.00},
		grid=both,
		minor tick num=1,
		axis background/.style={fill=ggplotBWBG},
	},
}

%% END: pgfplots
%% ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++



%% ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
%% Created by Dazhi Jiang, 2010-11-16 16:12:17 +0000 (Tue, 16 Nov 2010)
%% Captions

%%

%% * Define float placement parameters
\renewcommand{\topfraction}{.8}
\renewcommand{\bottomfraction}{.3}
\renewcommand{\textfraction}{.15}
\renewcommand{\floatpagefraction}{.66}
\renewcommand{\dbltopfraction}{.66}
\renewcommand{\dblfloatpagefraction}{.66}

\setcounter{topnumber}{9}
\setcounter{bottomnumber}{9}
\setcounter{totalnumber}{20}
\setcounter{dbltopnumber}{9}


%% * Specify the caption font
% \captionnamefont{\bfseries\small}
% \captiontitlefont{\small}
\captionnamefont{\bfseries}
% \captiontitlefont{\normalfont}

%% * Specify the caption width
% \normalcaptionwidth
\changecaptionwidth
%% !!! Memoir bugs ???
%%   - Somehow, the \textwidth is changed in figure evironment. So I define
%%     a width ratio which is over than 1.
\def\@suacse@caption@width@ratio{1.025}
\captionwidth{\@suacse@caption@width@ratio\textwidth}
% \captionwidth{1.025\textwidth}

%% END: Captions
%% ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++


%% ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
%% Created by Dazhi Jiang, 2010-12-26 11:40:45 +0000 (Sun, 26 Dec 2010)
%% Math

%% * Load math package
\RequirePackage{SUACSEThesisMath}  % Load Package 'SUACSEThesisMath'


%% END: Math
%% ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++


%% ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
%% Created by Dazhi Jiang, 2010-11-17 14:05:56 +0000 (Wed, 17 Nov 2010)
%% Initialise Keys

%% * Setting-up the default options
\pgfkeys{%
	/suacse/.cd,
	spacing=onehalf,
	% pagelayout=acseii,
	% font=cm,
	% loadextrachapsty=acsei,
}

\pgfkeys{%
	/suacseopt/.cd,
	spacing=onehalf,
	pagelayout=acseii,
	font=cm,
	% chapterstyle=acsei
}

%% END: Initialise Keys
%% ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++


%% ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
%% Created by Dazhi Jiang, 2010-11-18 13:11:44 +0000 (Thu, 18 Nov 2010)
%% Declare Package Options
%%   - Declare pgf package options
%%     Note that the command,\ProcessPgfPackageOptions, has to be put
%%     an proper place, see below,
%%     1. This declaration command has to be put after all \pgfkeys
%%     2. If the <if> keys are used directly, this command has to be put
%%        somewhere before the commands that include the <if> keys. This is
%%        because that the <if> keys are set in this command and will take
%%        the default value if the command is used after the <if> keys.
%%     3. Any command used by keys has to be defined before the declaration.
%%        You can define an empty command in advance, do the declaration
%%        and then renew it.
%%     4. Avoid to use the <if> keys directly. If necessary, define a new
%%        command within which the <if> keys is used and include this command
%%        into a key, /path/key/.append code.
%%     5. Put this command before the hyperref loaded since it sets up the
%%        options for hyperref
\ProcessPgfPackageOptions{/suacseopt}
%% END: Declare Package Options
%% ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++


%% ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
%% Created by Dazhi Jiang, 2010-12-13 10:35:16 +0000 (Mon, 13 Dec 2010)
%% Load Packages with Options Given by /suacseopt

%% * Packages have to be loaded before hyperref

%%   - 'float'
\RequirePackage{float}  % Load Package 'float'
% \usepackage{float}  % Load Package 'float'


%% * Load biblatex
\RequirePackage[\@suacse@biblatex@option]{biblatex}
\def\bibfont{\small}
% \bibliography{journals,phd,ARK}
% \renewcommand\bibname{References}

%% !!! Now we are safe to load hyperref
\RequirePackage[\@suacse@hyperref@option]{hyperref}
% \usepackage[\@suacse@hyperref@option]{hyperref}

%% * Load hyperref-related packages
% \AtBeginDocument{\hypersetup{pdfauthor={\@author},pdftitle={\@title}}}

\@ifpackageloaded{hyperref}{}{%
  \PackageError{hyperref}{I am not loaded!}
    {\string\pdfdef\space requires hyperref.}}

\RequirePackage[open,openlevel=4]{bookmark}
\RequirePackage{hypcap}

%% * Load glossaries
\RequirePackage[\@suacse@glossaries@option]{glossaries}  % Load Package 'glossaries'


%% * Load cleverref
%%   !!! Load the package 'cleveref' before 'algorithm' and 'algorithmicx' 
%%       (algpseudocode), otherwise you will get the following warining message
%%         pdfTeX warning (ext4): destination with the same identifier 
%%         (name{ALC@line.1}) has been already used, duplicate ignored.
%%       In addition, if you use \cref or \ref, the wrong reference positions
%%       are given.
%%       See, 
%%         http://www.macfreek.nl/mindmaster/LaTeX_package_conflicts
%%         http://developer.berlios.de/feature/?func=detailfeature&feature_id=2973&group_id=3442
%%         http://www.stud.uni-karlsruhe.de/~uucom/?p=99
\RequirePackage[capitalise]{cleveref}


%% * Pakcages have to be loaded after hyperref
%% * Algorithm-related packages
\RequirePackage{algorithm}			% Algorithm, in the package 'algorithms'
% \usepackage{algorithm}			% Algorithm, in the package 'algorithms'

%% ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
%%   - The 'algorithms' package and its settings
% \RequirePackage{algorithmic}  % Load Package 'algorithmic', in 'algorithms'

%%     - Redefined the leading label of the algorithm entry terms
%%       Require: -> Input:  &  Ensure: -> Output:
% \renewcommand\algorithmicrequire{\textbf{Input:}}%
% \renewcommand\algorithmicensure{\textbf{Output:}}%

% \newcommand{}{}


%% ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

%% ------------------------------------------------------------
%%   - The 'algorithmicx' package and its settings
\RequirePackage{algpseudocode}		% Algorithmic

% %% Required by titletoc, but should be commented when using \numberwithin
% %% Required by article style maybe.
% %\newcommand{\theHalgorithm}{\arabic{algorithm}}
% 
\algnewcommand\algorithmicto{\textbf{to}}
\algrenewtext{For}[3]%
{\algorithmicfor\ $#1 \gets #2\ \algorithmicto\ #3$ \algorithmicdo}

\algrenewcommand\algorithmicrequire{\textbf{Input:}}%
\algrenewcommand\algorithmicensure{\textbf{Output:}}%
% % \algrenewcommand\algorithmiccomment[1]{\hfill\(\triangleright\) #1}%
% % \algrenewcommand\algorithmiccomment[1]{\hfill\(\blacktriangleright\) #1}%

%% ------------------------------------------------------------


% %% * Load cleverref
% \RequirePackage[capitalise]{cleveref}


%% END: Load Packages with Options Given by /suacseopt
%% ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++


%% ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
%% Created by Dazhi Jiang, 2010-11-16 16:42:17 +0000 (Tue, 16 Nov 2010)
%% Commands

%% * Floats
%%   - Renew the environments, figure and table, so that they are automatically
%%     centred and hooked to the \capstart
\renewenvironment{figure}[1][\fps@figure]
                 {\edef\@tempa{\noexpand\@float{figure}[#1]}
                  \@tempa\capstart\centering}
                 {\end@float}
\renewenvironment{table}[1][\fps@table]
                 {\edef\@tempa{\noexpand\@float{table}[#1]}
                  \@tempa\capstart\centering}
                 {\end@float}
%% !!! A few comment
%% The command \capstart is defined in the package 'hypcap'


%% * Abbreviation
\newcommand{\eg}{e.g.,\xspace}			% <Package>: xspace
\newcommand{\ie}{i.e.,\xspace}          % <Package>: xspace
\newcommand{\etc}{etc.\@\xspace}        % <Package>: xspace


%% * Symbol
% \newcommand{\ttbs}{\char'134} % double quotation marks


%% END: Commands
%% ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++


%% ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
%% Created by Dazhi Jiang, 2010-11-18 11:59:23 +0000 (Thu, 18 Nov 2010)
%% MISC

\AtBeginDocument{\hypersetup{pdfauthor={\@author},pdftitle={\@title}}}

%% Declare subfloat
\newsubfloat{figure}


% \csdef{blx@opts@type@\abx@field@entrytype}{}

%% END: MISC
%% ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++


\endinput
